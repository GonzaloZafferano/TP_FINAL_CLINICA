"use strict";(self.webpackChunkTP_CLINICA=self.webpackChunkTP_CLINICA||[]).push([[937],{7937:(sr,w,m)=>{m.r(w),m.d(w,{RegistroModule:()=>ir});var g=m(6895),f=m(6378),v=m(3474),e=m(4650),x=m(7556),b=m(1209);function S(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",9)(2,"h3",10),e._uU(3," Seleccione el tipo de usuario que desea registrar. "),e.qZA(),e._UZ(4,"img",11),e.qZA(),e.BQk())}let j=(()=>{class i{constructor(r,o,n){this.authService=r,this.usuarioService=o,this.router=n,this.ocultarBtnCuentaUsuario=!1,this.ocultarBtnCuentaAdmin=!1,this.ocultarBtnCuentaEspecialista=!1,this.ocultarLogo=!1}ngOnInit(){let r=this.router.url;this.ocultarLogo="/registro"!=r&&"/usuarios/registro"!=r,this.ocultarBtnCuentaEspecialista=r.includes("registro/especialista"),this.ocultarBtnCuentaUsuario=r.includes("registro/usuario"),this.ocultarBtnCuentaAdmin=r.includes("registro/administrador")}esAdministrador(){let r=this.verificarEstadoDeUsuario();return null!=r&&r.perfil==v.L.administrador}usuarioEstaLogueado(){return this.usuarioService.getUsuarioEstaLogueado}verificarEstadoDeUsuario(){return this.usuarioService.getUsuarioActualBasico}cuenta(r){1==r?(this.ocultarBtnCuentaAdmin=!0,this.ocultarBtnCuentaUsuario=!1,this.ocultarBtnCuentaEspecialista=!1):2==r?(this.ocultarBtnCuentaAdmin=!1,this.ocultarBtnCuentaUsuario=!1,this.ocultarBtnCuentaEspecialista=!0):3==r&&(this.ocultarBtnCuentaAdmin=!1,this.ocultarBtnCuentaUsuario=!0,this.ocultarBtnCuentaEspecialista=!1),this.ocultarLogo=!0}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(x.e),e.Y36(b.i),e.Y36(f.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-registro"]],decls:11,vars:5,consts:[["routerLink","",1,"btn","btn-primary","fs-4","fw-bold","p-2","m-2",3,"hidden"],[4,"ngIf"],[1,"d-flex","justify-content-center"],["routerLink","usuario",1,"btn","btn-primary","botones","fs-4","fw-bold","p-2","m-2",3,"hidden","click"],["src","../assets/fotosPerfil/usuarios.png","width","50px",1,"img-foto"],["routerLink","especialista",1,"btn","btn-primary","botones","fs-4","fw-bold","p-2","m-2",3,"hidden","click"],["src","../assets/fotosPerfil/especialistas.jpg","width","50px",1,"img-foto"],["routerLink","administrador",1,"btn","btn-primary","botones","fs-4","fw-bold","p-2","m-2",3,"hidden","click"],["src","../assets/fotosPerfil/administradores.png","width","50px",1,"img-foto"],[1,"text-center"],[1,"fw-bold","fs-2","text-dark"],["src","assets/logo/logo192x192.png","alt","imagen-usuario",1,"card-img-top","w-25"]],template:function(r,o){1&r&&(e.TgZ(0,"button",0),e._uU(1,"Volver a Bienvenido"),e.qZA(),e.YNc(2,S,5,0,"ng-container",1),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return o.cuenta(3)}),e._UZ(5,"img",4),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return o.cuenta(2)}),e._UZ(7,"img",6),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return o.cuenta(1)}),e._UZ(9,"img",8),e.qZA()(),e._UZ(10,"router-outlet")),2&r&&(e.Q6J("hidden",o.usuarioEstaLogueado()),e.xp6(2),e.Q6J("ngIf",!o.ocultarLogo),e.xp6(2),e.Q6J("hidden",o.ocultarBtnCuentaUsuario),e.xp6(2),e.Q6J("hidden",o.ocultarBtnCuentaEspecialista),e.xp6(2),e.Q6J("hidden",o.ocultarBtnCuentaAdmin||!o.esAdministrador()))},dependencies:[g.O5,f.lC,f.rH],styles:[".botones[_ngcontent-%COMP%]{background:rgb(76,204,62);border-radius:50%;border:none}.img-foto[_ngcontent-%COMP%]{border-radius:50%;height:150px;width:150px}"]}),i})();var N=m(5861),a=m(4006),A=m(4128),p=m(4500);class k{constructor(){this.id="",this.correo="",this.nombre="",this.apellido="",this.dni=0,this.imagen1="",this.imagen2="",this.edad=0,this.obraSocial=0,this.habilitado=p.j.espera,this.correoRegistrado=!1,this.perfil=v.L.paciente,this.fechaRegistro=new Date,this.tieneHC=!1}}class _{constructor(){this.validando=!1}}var s=m(5708),C=m(6069),y=m(9724),E=m(8906),U=m(4465),T=m(605),Z=m(8242);function J(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.nombre?null:o.nombre.getError(r).mensaje," ")}}function q(i,t){if(1&i&&(e.ynx(0),e.YNc(1,J,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.nombre?null:r.nombre.errors))}}function I(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.apellido?null:o.apellido.getError(r).mensaje," ")}}function Y(i,t){if(1&i&&(e.ynx(0),e.YNc(1,I,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.apellido?null:r.apellido.errors))}}function F(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.edad?null:o.edad.getError(r).mensaje," ")}}function O(i,t){if(1&i&&(e.ynx(0),e.YNc(1,F,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.edad?null:r.edad.errors))}}function B(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",35)(2,"span",36),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",37),e.qZA(),e.BQk())}function V(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.dni?null:o.dni.getError(r).mensaje," ")}}function M(i,t){if(1&i&&(e.ynx(0),e.YNc(1,V,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.dni?null:r.dni.errors))}}function P(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.obraSocial?null:o.obraSocial.getError(r).mensaje," ")}}function $(i,t){if(1&i&&(e.ynx(0),e.YNc(1,P,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.obraSocial?null:r.obraSocial.errors))}}function L(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",35)(2,"span",36),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",37),e.qZA(),e.BQk())}function D(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.correo?null:o.correo.getError(r).mensaje," ")}}function G(i,t){if(1&i&&(e.ynx(0),e.YNc(1,D,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.correo?null:r.correo.errors))}}function H(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.clave?null:o.clave.getError(r).mensaje," ")}}function K(i,t){if(1&i&&(e.ynx(0),e.YNc(1,H,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.clave?null:r.clave.errors))}}function z(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.confirmarClave?null:o.confirmarClave.getError(r).mensaje," ")}}function X(i,t){if(1&i&&(e.ynx(0),e.YNc(1,z,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.confirmarClave?null:r.confirmarClave.errors))}}function W(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen1?null:o.imagen1.getError(r).mensaje," ")}}function ee(i,t){if(1&i&&(e.ynx(0),e.YNc(1,W,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen1?null:r.imagen1.errors))}}function re(i,t){if(1&i&&(e.TgZ(0,"small",34),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen2?null:o.imagen2.getError(r).mensaje," ")}}function oe(i,t){if(1&i&&(e.ynx(0),e.YNc(1,re,2,1,"small",33),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen2?null:r.imagen2.errors))}}function ie(i,t){1&i&&e._UZ(0,"app-loader")}let te=(()=>{class i{get nombre(){return this.form?.get("nombre")}set nombre(r){this.form?.get("nombre")?.patchValue(r)}get apellido(){return this.form?.get("apellido")}set apellido(r){this.form?.get("apellido")?.patchValue(r)}get edad(){return this.form?.get("edad")}set edad(r){this.form?.get("edad")?.patchValue(r)}get dni(){return this.form?.get("dni")}set dni(r){this.form?.get("dni")?.patchValue(r)}get obraSocial(){return this.form?.get("obraSocial")}set obraSocial(r){this.form?.get("obraSocial")?.patchValue(r)}get correo(){return this.form?.get("correo")}set correo(r){this.form?.get("correo")?.patchValue(r)}get clave(){return this.form?.get("clave")}set clave(r){this.form?.get("clave")?.patchValue(r)}get confirmarClave(){return this.form?.get("confirmarClave")}set confirmarClave(r){this.form?.get("confirmarClave")?.patchValue(r)}get imagen1(){return this.form?.get("imagen1")}set imagen1(r){this.form?.get("imagen1")?.patchValue(r)}get imagen2(){return this.form?.get("imagen2")}set imagen2(r){this.form?.get("imagen2")?.patchValue(r)}constructor(r,o,n,l,c,d,u,h){this.router=r,this.authService=o,this.formato=n,this.usuarioService=l,this.formBuilder=c,this.swalService=d,this.firestorageService=u,this.toastService=h,this.cargando=!1,this.archivos=[],this.siteKey="6LfKPZEmAAAAAGDBK0uVurfxhxuQGydWQI2jjlBe",this.validarCorreo=new _,this.validarDni=new _}ngOnInit(){this.aFormGroup=this.formBuilder.group({recaptcha:["",a.kI.required]}),this.form=new a.cw({nombre:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),apellido:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),edad:new a.NI("",{validators:[(0,s.Ms)(18,99)]}),dni:new a.NI("",{validators:[(0,s.Ms)(1e7,99999999)],asyncValidators:(0,s.j8)(this.usuarioService,this.validarDni),updateOn:"blur"}),obraSocial:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),imagen1:new a.NI("",{validators:[(0,s.FQ)()]}),imagen2:new a.NI("",{validators:[(0,s.FQ)()]}),correo:new a.NI("",{validators:[(0,s.qc)()],asyncValidators:(0,s.y$)(this.usuarioService,this.validarCorreo,this.formato),updateOn:"blur"}),clave:new a.NI("",{validators:[(0,s.$k)(6,20,null,!1,!1)]}),confirmarClave:new a.NI("",{validators:[(0,s.$k)(6,20,null,!1,!1)]})},[(0,s.U5)(6)])}obtenerErrores(r){return this.cargando?[]:Object.keys(r)}registrarUsuario(){this.formEsValido()?this.aFormGroup.invalid?this.toastService.error("Falta validar Captcha","Registro inv\xe1lido."):this.registrarUsuarioEnFirestore():this.toastService.error("Hay campos con errores. <br>Por favor corrijalos y vuelva a intentar","Registro inv\xe1lido.")}cargarArchivo(r,o){this.archivos[r]=o?.target?.files[0]}formEsValido(){for(const r in this.form.controls)if(this.form.controls.hasOwnProperty(r)&&this.form.controls[r]?.errors)return!1;return!(this.validarCorreo.validando||this.validarDni.validando)}registrarUsuarioEnFirestore(){var r=this;return(0,N.Z)(function*(){r.cargando=!0,r.authService.registrarUsuarioConVerificacion(r.correo?.value,r.clave?.value).then(o=>{let n=o.user?.uid;if(null!=n){let l=[];for(const c of r.archivos){let d=r.firestorageService.guardarArchivo(c,"fotosUsuario/"+r.nombre.value+"_"+Math.floor(1e3*Math.random())+"_"+r.formato.fechaToString(new Date,!1,!0));d.subscribe(u=>u),l.push(d)}(0,A.D)(l).subscribe(c=>{if(c&&2==c.length){let d=new k;d.id=n??"",d.obraSocial=r.obraSocial.value,d.nombre=r.nombre.value,d.apellido=r.apellido.value,d.dni=r.dni.value,d.correo=r.formato.eliminarEspaciosYPasarAMin_May(r.correo.value),d.edad=r.edad.value,d.habilitado=p.j.habilitado,d.correoRegistrado=!0,d.imagen1=c[0],d.imagen2=c[1],d.fechaRegistro=new Date,r.usuarioService.cargarUsuarioConIdAsignado(d).then(u=>{r.limpiarFormulario(),r.cargando=!1,r.toastService.exito("El registro se ha completado exitosamente!.","Registro exitoso"),r.authService.logOut(),r.usuarioService.limpiarUsuarioActual(),r.swalService.exito("El registro se ha completado exitosamente. Por favor, ingrese a su cuenta para verificar su correo electr\xf3nico y, a continuaci\xf3n, inicie sesi\xf3n.","AVISO"),r.router.navigate(["../login"])})}})}else r.toastService.error("Ha ocurrido un error al intentar guardar los datos del usuario registrado.","Ha ocurrido un error."),r.cargando=!1}).catch(o=>{r.obtenerErrorAuth(o)})})()}obtenerErrorAuth(r){let o="";switch(r.code){case"auth/invalid-email":o="Formato de correo electr\xf3nico inv\xe1lido.";break;case"auth/missing-password":o="Falta ingresar la contrase\xf1a.";break;case"auth/weak-password":o="La contrase\xf1a debe contener al menos 6 caracteres.";break;case"auth/email-already-in-use":o="El correo electr\xf3nico ingresado ya est\xe1 en uso.";break;default:o="Ha ocurrido un error y no se pudo registrar el usuario."}""!=o&&(this.toastService.error(o,"Ha ocurrido un error!"),this.cargando=!1)}limpiarFormulario(){this.form.reset(),this.archivos=[];for(const r in this.form.controls)this.form.controls.hasOwnProperty(r)&&this.form.controls[r].setValue("")}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(f.F0),e.Y36(x.e),e.Y36(C.y),e.Y36(b.i),e.Y36(a.qu),e.Y36(y.J),e.Y36(E.X),e.Y36(U.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-registro-usuario"]],decls:72,vars:18,consts:[[1,"container"],[1,"row","w-100","d-flex","justify-content-center","ml-0"],[1,"col","col-12","justify-content-center","col-lg-12"],[1,"card","p-4","mt-4","centrar","sombra-luminosa"],[3,"formGroup"],[1,"display","justify-content-between","w-100"],[1,"width","p-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","text","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],["for","obraSocial",1,"form-label"],["type","text","id","obraSocial","formControlName","obraSocial",1,"form-control"],["for","correo",1,"form-label"],["type","text","id","correo","formControlName","correo",1,"form-control"],["for","clave",1,"form-label"],["type","password","id","clave","formControlName","clave",1,"form-control"],["for","confirmarClave",1,"form-label"],["type","password","id","confirmarClave","formControlName","confirmarClave",1,"form-control"],["for","imagen1",1,"form-label"],["type","file","formControlName","imagen1","name","imagen1","id","imagen1","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],["for","imagen2",1,"form-label"],["type","file","formControlName","imagen2","name","imagen2","id","imagen2","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],["formControlName","recaptcha",3,"siteKey"],["captchaElem",""],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["type","button",1,"btn","btn-primary","mt-2","fw-bold",3,"click"],["class","d-block error",4,"ngFor","ngForOf"],[1,"d-block","error"],[1,"d-flex","justify-content-start",2,"align-items","center","height","100% !important"],[1,"m-0","fs-6","fw-bold","text-primary"],[1,"spinner-border","text-primary",2,"align-self","center","scale","0.5"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"fieldset")(6,"legend"),e._uU(7," Complete sus datos para registrarse (USUARIO) "),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"label",7),e._uU(12,"Nombre"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,q,2,1,"ng-container",9),e.qZA(),e.TgZ(15,"div")(16,"label",10),e._uU(17,"Apellido"),e.qZA(),e._UZ(18,"input",11),e.YNc(19,Y,2,1,"ng-container",9),e.qZA(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Edad"),e.qZA(),e._UZ(23,"input",13),e.YNc(24,O,2,1,"ng-container",9),e.qZA(),e.TgZ(25,"div")(26,"label",14),e._uU(27,"DNI"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,B,5,0,"ng-container",9),e.YNc(30,M,2,1,"ng-container",9),e.qZA(),e.TgZ(31,"div")(32,"label",16),e._uU(33,"Obra Social"),e.qZA(),e._UZ(34,"input",17),e.YNc(35,$,2,1,"ng-container",9),e.qZA()(),e.TgZ(36,"div",6)(37,"div")(38,"label",18),e._uU(39,"Correo Electronico"),e.qZA(),e._UZ(40,"input",19),e.YNc(41,L,5,0,"ng-container",9),e.YNc(42,G,2,1,"ng-container",9),e.qZA(),e.TgZ(43,"div")(44,"label",20),e._uU(45,"Contrase\xf1a"),e.qZA(),e._UZ(46,"input",21),e.YNc(47,K,2,1,"ng-container",9),e.qZA(),e.TgZ(48,"div")(49,"label",22),e._uU(50,"Reingrese Contrase\xf1a"),e.qZA(),e._UZ(51,"input",23),e.YNc(52,X,2,1,"ng-container",9),e.qZA(),e.TgZ(53,"div")(54,"label",24),e._uU(55,"Imagen para Perfil (1)"),e.qZA(),e.TgZ(56,"input",25),e.NdJ("change",function(l){return o.cargarArchivo(0,l)}),e.qZA(),e.YNc(57,ee,2,1,"ng-container",9),e.qZA(),e.TgZ(58,"div")(59,"label",26),e._uU(60,"Imagen para Perfil (2)"),e.qZA(),e.TgZ(61,"input",27),e.NdJ("change",function(l){return o.cargarArchivo(1,l)}),e.qZA(),e.YNc(62,oe,2,1,"ng-container",9),e.qZA()()(),e.TgZ(63,"form",4),e._UZ(64,"ngx-recaptcha2",28,29),e.qZA(),e.TgZ(66,"div",30)(67,"button",31),e.NdJ("click",function(){return o.limpiarFormulario()}),e._uU(68," Limpiar "),e.qZA(),e.TgZ(69,"button",32),e.NdJ("click",function(){return o.registrarUsuario()}),e._uU(70," Registrar "),e.qZA()()()()()()()(),e.YNc(71,ie,1,0,"app-loader",9)),2&r&&(e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("ngIf",null==o.nombre?null:o.nombre.errors),e.xp6(5),e.Q6J("ngIf",null==o.apellido?null:o.apellido.errors),e.xp6(5),e.Q6J("ngIf",null==o.edad?null:o.edad.errors),e.xp6(5),e.Q6J("ngIf",o.validarDni.validando),e.xp6(1),e.Q6J("ngIf",null==o.dni?null:o.dni.errors),e.xp6(5),e.Q6J("ngIf",null==o.obraSocial?null:o.obraSocial.errors),e.xp6(6),e.Q6J("ngIf",o.validarCorreo.validando),e.xp6(1),e.Q6J("ngIf",null==o.correo?null:o.correo.errors),e.xp6(5),e.Q6J("ngIf",null==o.clave?null:o.clave.errors),e.xp6(5),e.Q6J("ngIf",null==o.confirmarClave?null:o.confirmarClave.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen1?null:o.imagen1.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen2?null:o.imagen2.errors),e.xp6(1),e.Q6J("formGroup",o.aFormGroup),e.xp6(1),e.Q6J("siteKey",o.siteKey),e.xp6(7),e.Q6J("ngIf",o.cargando))},dependencies:[g.sg,g.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,T.R,Z.to],styles:[".error[_ngcontent-%COMP%]{color:red}.display[_ngcontent-%COMP%]{display:flex}.width[_ngcontent-%COMP%]{width:50%}@media (max-width: 700px){.display[_ngcontent-%COMP%]{display:block}.width[_ngcontent-%COMP%]{width:100%}}"]}),i})();class ae{constructor(){this.id="",this.correo="",this.nombre="",this.apellido="",this.dni=0,this.imagen="",this.edad=0,this.habilitado=p.j.espera,this.correoRegistrado=!1,this.perfil=v.L.administrador,this.fechaRegistro=new Date}}function ne(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.nombre?null:o.nombre.getError(r).mensaje," ")}}function le(i,t){if(1&i&&(e.ynx(0),e.YNc(1,ne,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.nombre?null:r.nombre.errors))}}function se(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.apellido?null:o.apellido.getError(r).mensaje," ")}}function ce(i,t){if(1&i&&(e.ynx(0),e.YNc(1,se,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.apellido?null:r.apellido.errors))}}function de(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.edad?null:o.edad.getError(r).mensaje," ")}}function ue(i,t){if(1&i&&(e.ynx(0),e.YNc(1,de,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.edad?null:r.edad.errors))}}function me(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",31)(2,"span",32),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",33),e.qZA(),e.BQk())}function pe(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.dni?null:o.dni.getError(r).mensaje," ")}}function ge(i,t){if(1&i&&(e.ynx(0),e.YNc(1,pe,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.dni?null:r.dni.errors))}}function fe(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",31)(2,"span",32),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",33),e.qZA(),e.BQk())}function he(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.correo?null:o.correo.getError(r).mensaje," ")}}function _e(i,t){if(1&i&&(e.ynx(0),e.YNc(1,he,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.correo?null:r.correo.errors))}}function ve(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.clave?null:o.clave.getError(r).mensaje," ")}}function be(i,t){if(1&i&&(e.ynx(0),e.YNc(1,ve,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.clave?null:r.clave.errors))}}function xe(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.confirmarClave?null:o.confirmarClave.getError(r).mensaje," ")}}function Ce(i,t){if(1&i&&(e.ynx(0),e.YNc(1,xe,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.confirmarClave?null:r.confirmarClave.errors))}}function Ze(i,t){if(1&i&&(e.TgZ(0,"small",30),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen1?null:o.imagen1.getError(r).mensaje," ")}}function Ae(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Ze,2,1,"small",29),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen1?null:r.imagen1.errors))}}function ye(i,t){1&i&&e._UZ(0,"app-loader")}let Ee=(()=>{class i{get nombre(){return this.form?.get("nombre")}set nombre(r){this.form?.get("nombre")?.patchValue(r)}get apellido(){return this.form?.get("apellido")}set apellido(r){this.form?.get("apellido")?.patchValue(r)}get edad(){return this.form?.get("edad")}set edad(r){this.form?.get("edad")?.patchValue(r)}get dni(){return this.form?.get("dni")}set dni(r){this.form?.get("dni")?.patchValue(r)}get correo(){return this.form?.get("correo")}set correo(r){this.form?.get("correo")?.patchValue(r)}get clave(){return this.form?.get("clave")}set clave(r){this.form?.get("clave")?.patchValue(r)}get confirmarClave(){return this.form?.get("confirmarClave")}set confirmarClave(r){this.form?.get("confirmarClave")?.patchValue(r)}get imagen1(){return this.form?.get("imagen1")}set imagen1(r){this.form?.get("imagen1")?.patchValue(r)}constructor(r,o,n,l,c,d,u,h){this.router=r,this.authService=o,this.formato=n,this.usuarioService=l,this.swalService=c,this.formBuilder=d,this.firestorageService=u,this.toastService=h,this.cargando=!1,this.archivos=[],this.siteKey="6LfKPZEmAAAAAGDBK0uVurfxhxuQGydWQI2jjlBe",this.validarCorreo=new _,this.validarDni=new _}ngOnInit(){this.aFormGroup=this.formBuilder.group({recaptcha:["",a.kI.required]}),this.form=new a.cw({nombre:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),apellido:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),edad:new a.NI("",{validators:[(0,s.Ms)(18,99)]}),dni:new a.NI("",{validators:[(0,s.Ms)(1e7,99999999)],asyncValidators:(0,s.j8)(this.usuarioService,this.validarDni),updateOn:"blur"}),imagen1:new a.NI("",{validators:[(0,s.FQ)()]}),correo:new a.NI("",{validators:[(0,s.qc)()],asyncValidators:(0,s.y$)(this.usuarioService,this.validarCorreo,this.formato),updateOn:"blur"}),clave:new a.NI("",{validators:[(0,s.$k)(6,20,null,!1,!1)]}),confirmarClave:new a.NI("",{validators:[(0,s.$k)(6,20,null,!1,!1)]})},[(0,s.U5)(6)])}obtenerErrores(r){return this.cargando?[]:Object.keys(r)}registrarUsuario(){this.formEsValido()?this.aFormGroup.invalid?this.toastService.error("Falta validar Captcha","Registro inv\xe1lido."):this.registrarUsuarioEnFirestore():this.toastService.error("Hay campos con errores. <br>Por favor corrijalos y vuelva a intentar","Registro inv\xe1lido.")}cargarArchivo(r,o){this.archivos[r]=o?.target?.files[0]}formEsValido(){for(const r in this.form.controls)if(this.form.controls.hasOwnProperty(r)&&this.form.controls[r]?.errors)return!1;return!(this.validarCorreo.validando||this.validarDni.validando)}registrarUsuarioEnFirestore(){this.cargando=!0,this.authService.registrarUsuarioConVerificacion(this.correo?.value,this.clave?.value).then(r=>{let o=r.user?.uid;if(null!=o){let n=[];for(const l of this.archivos){let c=this.firestorageService.guardarArchivo(l,"fotosUsuario/"+this.nombre.value+"_"+Math.floor(1e3*Math.random())+"_"+this.formato.fechaToString(new Date,!1,!0));c.subscribe(d=>d),n.push(c)}(0,A.D)(n).subscribe(l=>{if(l&&1==l.length){let c=new ae;c.id=o??"",c.nombre=this.nombre.value,c.apellido=this.apellido.value,c.dni=this.dni.value,c.correo=this.formato.eliminarEspaciosYPasarAMin_May(this.correo.value),c.edad=this.edad.value,c.habilitado=p.j.habilitado,c.correoRegistrado=!0,c.imagen=l[0],c.fechaRegistro=new Date,this.usuarioService.cargarUsuarioConIdAsignado(c).then(d=>{this.limpiarFormulario(),this.cargando=!1,this.toastService.exito("El registro se ha completado exitosamente!.","Registro exitoso"),this.authService.logOut(),this.usuarioService.limpiarUsuarioActual(),this.swalService.exito("El registro se ha completado exitosamente. Por favor, ingrese a su cuenta para verificar su correo electr\xf3nico y, a continuaci\xf3n, inicie sesi\xf3n.","AVISO"),this.router.navigate(["../login"])})}})}else this.toastService.error("Ha ocurrido un error al intentar guardar los datos del usuario registrado.","Ha ocurrido un error."),this.cargando=!1}).catch(r=>{this.obtenerErrorAuth(r)})}obtenerErrorAuth(r){let o="";switch(r.code){case"auth/invalid-email":o="Formato de correo electr\xf3nico inv\xe1lido.";break;case"auth/missing-password":o="Falta ingresar la contrase\xf1a.";break;case"auth/weak-password":o="La contrase\xf1a debe contener al menos 6 caracteres.";break;case"auth/email-already-in-use":o="El correo electr\xf3nico ingresado ya est\xe1 en uso.";break;default:o="Ha ocurrido un error y no se pudo registrar el usuario."}""!=o&&(this.toastService.error(o,"Ha ocurrido un error!"),this.cargando=!1)}limpiarFormulario(){this.form.reset(),this.archivos=[];for(const r in this.form.controls)this.form.controls.hasOwnProperty(r)&&this.form.controls[r].setValue("")}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(f.F0),e.Y36(x.e),e.Y36(C.y),e.Y36(b.i),e.Y36(y.J),e.Y36(a.qu),e.Y36(E.X),e.Y36(U.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-registro-admin"]],decls:62,vars:15,consts:[[1,"container"],[1,"row","w-100","d-flex","justify-content-center","ml-0"],[1,"col","col-12","justify-content-center","col-lg-12"],[1,"card","p-4","mt-4","centrar","sombra-luminosa"],[3,"formGroup"],[1,"display","justify-content-between","w-100"],[1,"width","p-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","text","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],["for","correo",1,"form-label"],["type","text","id","correo","formControlName","correo",1,"form-control"],["for","clave",1,"form-label"],["type","password","id","clave","formControlName","clave",1,"form-control"],["for","confirmarClave",1,"form-label"],["type","password","id","confirmarClave","formControlName","confirmarClave",1,"form-control"],["for","imagen1",1,"form-label"],["type","file","formControlName","imagen1","name","imagen1","id","imagen1","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],["formControlName","recaptcha",3,"siteKey"],["captchaElem",""],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["type","button",1,"btn","btn-primary","mt-2","fw-bold",3,"click"],["class","d-block error",4,"ngFor","ngForOf"],[1,"d-block","error"],[1,"d-flex","justify-content-start",2,"align-items","center","height","100% !important"],[1,"m-0","fs-6","fw-bold","text-primary"],[1,"spinner-border","text-primary",2,"align-self","center","scale","0.5"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"fieldset")(6,"legend"),e._uU(7," Complete sus datos para registrarse (ADMIN) "),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"label",7),e._uU(12,"Nombre"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,le,2,1,"ng-container",9),e.qZA(),e.TgZ(15,"div")(16,"label",10),e._uU(17,"Apellido"),e.qZA(),e._UZ(18,"input",11),e.YNc(19,ce,2,1,"ng-container",9),e.qZA(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Edad"),e.qZA(),e._UZ(23,"input",13),e.YNc(24,ue,2,1,"ng-container",9),e.qZA(),e.TgZ(25,"div")(26,"label",14),e._uU(27,"DNI"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,me,5,0,"ng-container",9),e.YNc(30,ge,2,1,"ng-container",9),e.qZA()(),e.TgZ(31,"div",6)(32,"div")(33,"label",16),e._uU(34,"Correo Electronico"),e.qZA(),e._UZ(35,"input",17),e.YNc(36,fe,5,0,"ng-container",9),e.YNc(37,_e,2,1,"ng-container",9),e.qZA(),e.TgZ(38,"div")(39,"label",18),e._uU(40,"Contrase\xf1a"),e.qZA(),e._UZ(41,"input",19),e.YNc(42,be,2,1,"ng-container",9),e.qZA(),e.TgZ(43,"div")(44,"label",20),e._uU(45,"Reingrese Contrase\xf1a"),e.qZA(),e._UZ(46,"input",21),e.YNc(47,Ce,2,1,"ng-container",9),e.qZA(),e.TgZ(48,"div")(49,"label",22),e._uU(50,"Imagen para Perfil"),e.qZA(),e.TgZ(51,"input",23),e.NdJ("change",function(l){return o.cargarArchivo(0,l)}),e.qZA(),e.YNc(52,Ae,2,1,"ng-container",9),e.qZA()()(),e.TgZ(53,"form",4),e._UZ(54,"ngx-recaptcha2",24,25),e.qZA(),e.TgZ(56,"div",26)(57,"button",27),e.NdJ("click",function(){return o.limpiarFormulario()}),e._uU(58," Limpiar "),e.qZA(),e.TgZ(59,"button",28),e.NdJ("click",function(){return o.registrarUsuario()}),e._uU(60," Registrar "),e.qZA()()()()()()()(),e.YNc(61,ye,1,0,"app-loader",9)),2&r&&(e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("ngIf",null==o.nombre?null:o.nombre.errors),e.xp6(5),e.Q6J("ngIf",null==o.apellido?null:o.apellido.errors),e.xp6(5),e.Q6J("ngIf",null==o.edad?null:o.edad.errors),e.xp6(5),e.Q6J("ngIf",o.validarDni.validando),e.xp6(1),e.Q6J("ngIf",null==o.dni?null:o.dni.errors),e.xp6(6),e.Q6J("ngIf",o.validarCorreo.validando),e.xp6(1),e.Q6J("ngIf",null==o.correo?null:o.correo.errors),e.xp6(5),e.Q6J("ngIf",null==o.clave?null:o.clave.errors),e.xp6(5),e.Q6J("ngIf",null==o.confirmarClave?null:o.confirmarClave.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen1?null:o.imagen1.errors),e.xp6(1),e.Q6J("formGroup",o.aFormGroup),e.xp6(1),e.Q6J("siteKey",o.siteKey),e.xp6(7),e.Q6J("ngIf",o.cargando))},dependencies:[g.sg,g.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,T.R,Z.to],styles:[".error[_ngcontent-%COMP%]{color:red}.display[_ngcontent-%COMP%]{display:flex}.width[_ngcontent-%COMP%]{width:50%}@media (max-width: 700px){.display[_ngcontent-%COMP%]{display:block}.width[_ngcontent-%COMP%]{width:100%}}"]}),i})();class Ue{constructor(){this.id="",this.correo="",this.nombre="",this.apellido="",this.dni=0,this.imagen="",this.edad=0,this.correoRegistrado=!1,this.perfil=v.L.especialista,this.especialidades=[],this.fechaRegistro=new Date,this.habilitado=p.j.espera,this.horarios=[]}}var R=m(1588),Q=m(2668),Te=m(9215);function we(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.nombre?null:o.nombre.getError(r).mensaje," ")}}function Ne(i,t){if(1&i&&(e.ynx(0),e.YNc(1,we,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.nombre?null:r.nombre.errors))}}function Re(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.apellido?null:o.apellido.getError(r).mensaje," ")}}function Qe(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Re,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.apellido?null:r.apellido.errors))}}function Se(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.edad?null:o.edad.getError(r).mensaje," ")}}function je(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Se,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.edad?null:r.edad.errors))}}function ke(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",44)(2,"span",45),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",46),e.qZA(),e.BQk())}function Je(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.dni?null:o.dni.getError(r).mensaje," ")}}function qe(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Je,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.dni?null:r.dni.errors))}}function Ie(i,t){if(1&i&&(e.TgZ(0,"option",47),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&i){const r=t.$implicit;e.s9C("value",r.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,r.nombre)," ")}}function Ye(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.especialidad?null:o.especialidad.getError(r).mensaje," ")}}function Fe(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Ye,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.especialidad?null:r.especialidad.errors))}}function Oe(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",44)(2,"span",45),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",46),e.qZA(),e.BQk())}function Be(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.otroEspecialidad?null:o.otroEspecialidad.getError(r).mensaje," ")}}function Ve(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Be,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.otroEspecialidad?null:r.otroEspecialidad.errors))}}function Me(i,t){1&i&&(e.ynx(0),e.TgZ(1,"div",44)(2,"span",45),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",46),e.qZA(),e.BQk())}function Pe(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.correo?null:o.correo.getError(r).mensaje," ")}}function $e(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Pe,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.correo?null:r.correo.errors))}}function Le(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.clave?null:o.clave.getError(r).mensaje," ")}}function De(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Le,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.clave?null:r.clave.errors))}}function Ge(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.confirmarClave?null:o.confirmarClave.getError(r).mensaje," ")}}function He(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Ge,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.confirmarClave?null:r.confirmarClave.errors))}}function Ke(i,t){if(1&i&&(e.TgZ(0,"small",43),e._uU(1),e.qZA()),2&i){const r=t.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen1?null:o.imagen1.getError(r).mensaje," ")}}function ze(i,t){if(1&i&&(e.ynx(0),e.YNc(1,Ke,2,1,"small",42),e.BQk()),2&i){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen1?null:r.imagen1.errors))}}function Xe(i,t){if(1&i&&e._UZ(0,"app-loader",48),2&i){const r=e.oxw();e.Q6J("texto",r.textoCarga)}}const We=function(i){return{deshabilitado:i}},er=[{path:"",component:j,children:[{path:"usuario",component:te},{path:"administrador",component:Ee,canActivate:[(()=>{class i{constructor(r,o){this.usuarioService=r,this.router=o}canActivate(r,o){return!(!this.usuarioService.getUsuarioActualBasico||this.usuarioService.getUsuarioActualBasico.perfil!=v.L.administrador)||(this.router.navigate(["home"]),!1)}canActivateChild(r,o){return!0}canDeactivate(r,o,n,l){return!0}}return i.\u0275fac=function(r){return new(r||i)(e.LFG(b.i),e.LFG(f.F0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()]},{path:"especialista",component:(()=>{class i{get nombre(){return this.form?.get("nombre")}set nombre(r){this.form?.get("nombre")?.patchValue(r)}get apellido(){return this.form?.get("apellido")}set apellido(r){this.form?.get("apellido")?.patchValue(r)}get edad(){return this.form?.get("edad")}set edad(r){this.form?.get("edad")?.patchValue(r)}get dni(){return this.form?.get("dni")}set dni(r){this.form?.get("dni")?.patchValue(r)}get correo(){return this.form?.get("correo")}set correo(r){this.form?.get("correo")?.patchValue(r)}get clave(){return this.form?.get("clave")}set clave(r){this.form?.get("clave")?.patchValue(r)}get confirmarClave(){return this.form?.get("confirmarClave")}set confirmarClave(r){this.form?.get("confirmarClave")?.patchValue(r)}get imagen1(){return this.form?.get("imagen1")}set imagen1(r){this.form?.get("imagen1")?.patchValue(r)}get especialidad(){return this.form?.get("especialidad")}set especialidad(r){this.form?.get("especialidad")?.patchValue(r)}get selectEspecialidades(){return this.form?.get("selectEspecialidades")}set selectEspecialidades(r){this.form?.get("selectEspecialidades")?.patchValue(r)}get otroEspecialidad(){return this.form?.get("otroEspecialidad")}set otroEspecialidad(r){this.form?.get("otroEspecialidad")?.patchValue(r)}get otro(){return this.form?.get("otro")}set otro(r){this.form?.get("otro")?.patchValue(r)}constructor(r,o,n,l,c,d,u,h,tr,ar,nr,lr){this.router=r,this.authService=o,this.swalService=n,this.especialidadService=l,this.formatoService=c,this.formato=d,this.usuarioService=u,this.firestorageService=h,this.formBuilder=tr,this.solicitudService=ar,this.especialidadesServices=nr,this.toastService=lr,this.cargando=!1,this.archivos=[],this.especialidades=[],this.especialidadesVisibles=[],this.especialidadesSeleccionadas=[],this.textoCarga="Cargando...",this.siteKey="6LfKPZEmAAAAAGDBK0uVurfxhxuQGydWQI2jjlBe",this.validarCorreo=new _,this.validarDni=new _,this.validarEspecialidad=new _,this.usuarioActual=null}ngOnInit(){this.aFormGroup=this.formBuilder.group({recaptcha:["",a.kI.required]}),this.usuarioService.obtenerUsuarioActual().then(r=>{this.usuarioActual=r}),this.especialidadesServices.obtenerListadoDeEspecialidadesObservable().subscribe(r=>{this.especialidades=r.map(o=>({nombre:o.nombre,id:o.id})),this.especialidades.unshift({nombre:"Otro",id:0}),this.especialidadesVisibles=this.especialidades}),this.form=new a.cw({nombre:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),apellido:new a.NI("",{validators:[(0,s.$k)(3,30,null,!0,!0)]}),edad:new a.NI("",{validators:[(0,s.Ms)(18,99)]}),dni:new a.NI("",{validators:[(0,s.Ms)(1e7,99999999)],asyncValidators:(0,s.j8)(this.usuarioService,this.validarDni),updateOn:"blur"}),imagen1:new a.NI("",{validators:[(0,s.FQ)()]}),correo:new a.NI("",{validators:[(0,s.qc)()],asyncValidators:(0,s.y$)(this.usuarioService,this.validarCorreo,this.formato),updateOn:"blur"}),clave:new a.NI("",{validators:[(0,s.$k)(6,20,null,!1,!1)]}),confirmarClave:new a.NI("",{validators:[(0,s.$k)(6,20,null,!1,!1)]}),especialidad:new a.NI("",{validators:[(0,s.$k)(1,150,null)]}),otro:new a.NI(""),otroEspecialidad:new a.NI("",{validators:[(0,s.$k)(1,150,null)],asyncValidators:(0,s.sH)(this.especialidadesServices,this.validarEspecialidad,this.formato),updateOn:"blur"}),selectEspecialidades:new a.NI("")},[(0,s.U5)(6),(0,s.wb)(3,30,"otro","otroEspecialidad",null,!1,!0)])}obtenerErrores(r){return this.cargando?[]:Object.keys(r)}registrarUsuario(){this.formEsValido()?this.aFormGroup.invalid?this.toastService.error("Falta validar Captcha","Registro inv\xe1lido."):this.realizarSolicitud():this.toastService.error("Hay campos con errores. <br>Por favor corrijalos y vuelva a intentar","Registro inv\xe1lido.")}cargarArchivo(r,o){this.archivos[r]=o?.target?.files[0]}formEsValido(){for(const r in this.form.controls)if(this.form.controls.hasOwnProperty(r)&&this.form.controls[r]?.errors)return!1;return!(this.validarCorreo.validando||this.validarDni.validando||this.validarEspecialidad.validando)}realizarSolicitud(){this.cargando=!0,this.desuscribir();let r={};r.id=(0,R.Z)(),r.nombre=this.nombre.value,r.apellido=this.apellido.value,r.dni=this.dni.value,r.correo=this.formato.eliminarEspaciosYPasarAMin_May(this.correo.value),r.edad=this.edad.value,r.habilitado=p.j.espera,r.correoRegistrado=!0,r.otroEspecialidad=this.otro.value?this.formato.eliminarEspaciosYPasarAMin_May(this.otroEspecialidad.value):"",r.especialidades=this.especialidadesSeleccionadas.length>0?this.especialidadesSeleccionadas:[],r.fechaRegistro=new Date,null==this.usuarioActual?this.solicitudService.cargarSolicitudConIdAsignado(r).then(o=>{this.esperandoHabilitacion(r)}):this.usuarioActual.perfil==v.L.administrador&&this.aceptarAutomaticamente(r)}aceptarAutomaticamente(r){if(r.habilitado=p.j.habilitado,""!=r.otroEspecialidad){let o={id:(0,R.Z)(),nombre:this.formatoService.eliminarEspaciosYPasarAMin_May(r.otroEspecialidad)};this.especialidadService.cargarEspecialidadConIdAsignado(o).then(n=>{r.especialidades.push(o),this.cargarUsuarioAceptado(r)})}else this.cargarUsuarioAceptado(r)}cargarUsuarioAceptado(r){this.authService.registrarUsuarioConVerificacion(this.correo?.value,this.clave?.value).then(o=>{let n=o.user?.uid;null!=n&&null!=n?this.solicitudService.eliminarSolicitud(r.id).then(l=>{let c=[];for(const d of this.archivos){let u=this.firestorageService.guardarArchivo(d,"fotosUsuario/"+this.nombre.value+"_"+Math.floor(1e3*Math.random())+"_"+this.formato.fechaToString(new Date,!1,!0));u.subscribe(h=>h),c.push(u)}(0,A.D)(c).subscribe(d=>{if(d&&1==d.length){let u=new Ue;u.apellido=r.apellido,u.correo=r.correo,u.correoRegistrado=r.correoRegistrado,u.dni=r.dni,u.edad=r.edad,u.especialidades=r.especialidades,u.fechaRegistro=r.fechaRegistro,u.imagen=d[0],u.nombre=r.nombre,u.id=n??"",u.habilitado=p.j.habilitado,this.usuarioService.cargarUsuarioConIdAsignado(u).then(h=>{this.cargando=!1,null==this.usuarioActual&&this.toastService.exito("Se ha habilitado su ingreso!","Aviso.",3500),this.authService.logOut(),this.usuarioService.limpiarUsuarioActual(),this.swalService.exito("El registro se ha completado exitosamente. Por favor, ingrese a su cuenta para verificar su correo electr\xf3nico y, a continuaci\xf3n, inicie sesi\xf3n.","AVISO"),this.router.navigate(["../login"])})}})}):(this.toastService.error("Ha ocurrido un error al intentar guardar los datos del usuario registrado.","Ha ocurrido un error."),this.cargando=!1)}).catch(o=>{this.obtenerErrorAuth(o)})}obtenerErrorAuth(r){let o="";switch(r.code){case"auth/invalid-email":o="Formato de correo electr\xf3nico inv\xe1lido.";break;case"auth/missing-password":o="Falta ingresar la contrase\xf1a.";break;case"auth/weak-password":o="La contrase\xf1a debe contener al menos 6 caracteres.";break;case"auth/email-already-in-use":o="El correo electr\xf3nico ingresado ya est\xe1 en uso.";break;default:o="Ha ocurrido un error y no se pudo registrar el usuario."}""!=o&&(this.toastService.error(o,"Ha ocurrido un error!"),this.cargando=!1)}limpiarFormulario(){this.form.reset(),this.archivos=[];for(const r in this.form.controls)this.form.controls.hasOwnProperty(r)&&this.form.controls[r].setValue("");this.limpiarEspecialidad(),this.textoCarga="Cargando..."}limpiarEspecialidad(){this.especialidadesSeleccionadas=[],this.especialidadesVisibles=this.especialidades,this.selectEspecialidades.enable(),this.selectEspecialidades=-1,this.especialidad="",this.otroEspecialidad="",this.otro=!1}checked(r){r.target.checked||this.limpiarEspecialidad()}seleccion(r){let o=r.target.value,n=this.especialidades.filter(l=>l.id==o)[0];0==n.id?(this.especialidad=n.nombre,this.otro=!0,this.selectEspecialidades.disable()):(this.especialidad=""==this.especialidad.value?n.nombre:`${this.especialidad.value}/${n.nombre}`,this.especialidadesSeleccionadas.push(n),this.especialidadesVisibles=this.especialidades.filter(l=>!this.especialidadesSeleccionadas.includes(l)),this.selectEspecialidades=-1)}esperandoHabilitacion(r){var o=this;return(0,N.Z)(function*(){o.desuscribir(),o.textoCarga="Aguarde unos instantes. Esperando habilitaci\xf3n...",o.suscripcion=o.solicitudService.traerSolicitudPorId_Observable(r.id).subscribe(n=>{if(n&&1==n.length){let l=n[0];l&&l.habilitado!=p.j.espera&&(l.habilitado==p.j.habilitado?o.cargarUsuarioAceptado(l):l.habilitado==p.j.rechazado&&o.solicitudService.eliminarSolicitud(l.id).then(c=>{o.cargando=!1,o.toastService.error("Se ha rechazado su solicitud. Motivo: "+l.mensajeEstado,"Aviso",4e3)}))}})})()}desuscribir(){this.suscripcion&&this.suscripcion.unsubscribe()}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(f.F0),e.Y36(x.e),e.Y36(y.J),e.Y36(Q.T),e.Y36(C.y),e.Y36(C.y),e.Y36(b.i),e.Y36(E.X),e.Y36(a.qu),e.Y36(Te.M),e.Y36(Q.T),e.Y36(U.k))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-registro-especialista"]],decls:87,vars:23,consts:[[1,"container"],[1,"row","w-100","d-flex","justify-content-center","ml-0"],[1,"col","col-12","justify-content-center","col-lg-12"],[1,"card","p-4","mt-4","centrar","sombra-luminosa"],[3,"formGroup"],[1,"display","justify-content-between","w-100"],[1,"width","p-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","text","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],["for","especialidad",1,"form-label","d-block"],["name","selectEspecialidades","id","selectEspecialidades","formControlName","selectEspecialidades",1,"w-100","form-select",3,"change"],["selected","","disabled","","value","-1"],[3,"value",4,"ngFor","ngForOf"],["readonly","","type","text","id","especialidad","formControlName","especialidad",1,"form-control","deshabilitado","fijo"],[1,"form-check"],["for","otroEspecialidad",1,"form-check-label"],["type","checkbox","formControlName","otro","id","otro","name","otro",1,"form-check-input",3,"change"],["check",""],["type","text","formControlName","otroEspecialidad","id","otroEspecialidad","name","otroEspecialidad",1,"form-control",3,"ngClass","readOnly"],[1,"d-flex","justify-content-end"],[1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["for","correo",1,"form-label"],["type","text","id","correo","formControlName","correo",1,"form-control"],["for","clave",1,"form-label"],["type","password","id","clave","formControlName","clave",1,"form-control"],["for","confirmarClave",1,"form-label"],["type","password","id","confirmarClave","formControlName","confirmarClave",1,"form-control"],["for","imagen1",1,"form-label"],["type","file","formControlName","imagen1","name","imagen1","id","imagen1","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],["formControlName","recaptcha",3,"siteKey"],["captchaElem",""],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["type","button",1,"btn","btn-primary","mt-2","fw-bold",3,"click"],[3,"texto",4,"ngIf"],["class","d-block error",4,"ngFor","ngForOf"],[1,"d-block","error"],[1,"d-flex","justify-content-start",2,"align-items","center","height","100% !important"],[1,"m-0","fs-6","fw-bold","text-primary"],[1,"spinner-border","text-primary",2,"align-self","center","scale","0.5"],[3,"value"],[3,"texto"]],template:function(r,o){if(1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"fieldset")(6,"legend"),e._uU(7," Complete sus datos para registrarse (ESPECIALISTA) "),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"label",7),e._uU(12,"Nombre"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,Ne,2,1,"ng-container",9),e.qZA(),e.TgZ(15,"div")(16,"label",10),e._uU(17,"Apellido"),e.qZA(),e._UZ(18,"input",11),e.YNc(19,Qe,2,1,"ng-container",9),e.qZA(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Edad"),e.qZA(),e._UZ(23,"input",13),e.YNc(24,je,2,1,"ng-container",9),e.qZA(),e.TgZ(25,"div")(26,"label",14),e._uU(27,"DNI"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,ke,5,0,"ng-container",9),e.YNc(30,qe,2,1,"ng-container",9),e.qZA()(),e.TgZ(31,"div",6)(32,"label",16),e._uU(33,"Especialidades"),e.qZA(),e.TgZ(34,"div")(35,"select",17),e.NdJ("change",function(l){return o.seleccion(l)}),e.TgZ(36,"optgroup")(37,"option",18),e._uU(38,"Seleccione especialidad..."),e.qZA(),e.YNc(39,Ie,3,4,"option",19),e.qZA()()(),e.TgZ(40,"label"),e._uU(41,"Especialidades seleccionadas"),e.qZA(),e._UZ(42,"textarea",20),e.YNc(43,Fe,2,1,"ng-container",9),e.TgZ(44,"div")(45,"div",21)(46,"label",22),e._uU(47,"Agregar otra especialidad"),e.qZA(),e.TgZ(48,"input",23,24),e.NdJ("change",function(l){return o.checked(l)}),e.qZA()(),e._UZ(50,"input",25),e.YNc(51,Oe,5,0,"ng-container",9),e.YNc(52,Ve,2,1,"ng-container",9),e.qZA(),e.TgZ(53,"div",26)(54,"button",27),e.NdJ("click",function(){return o.limpiarEspecialidad()}),e._uU(55,"Limpiar Especialidades"),e.qZA()()(),e.TgZ(56,"div",6)(57,"div")(58,"label",28),e._uU(59,"Correo Electronico"),e.qZA(),e._UZ(60,"input",29),e.YNc(61,Me,5,0,"ng-container",9),e.YNc(62,$e,2,1,"ng-container",9),e.qZA(),e.TgZ(63,"div")(64,"label",30),e._uU(65,"Contrase\xf1a"),e.qZA(),e._UZ(66,"input",31),e.YNc(67,De,2,1,"ng-container",9),e.qZA(),e.TgZ(68,"div")(69,"label",32),e._uU(70,"Reingrese Contrase\xf1a"),e.qZA(),e._UZ(71,"input",33),e.YNc(72,He,2,1,"ng-container",9),e.qZA(),e.TgZ(73,"div")(74,"label",34),e._uU(75,"Imagen para Perfil"),e.qZA(),e.TgZ(76,"input",35),e.NdJ("change",function(l){return o.cargarArchivo(0,l)}),e.qZA(),e.YNc(77,ze,2,1,"ng-container",9),e.qZA()()(),e.TgZ(78,"form",4),e._UZ(79,"ngx-recaptcha2",36,37),e.qZA(),e.TgZ(81,"div",38)(82,"button",39),e.NdJ("click",function(){return o.limpiarFormulario()}),e._uU(83," Limpiar "),e.qZA(),e.TgZ(84,"button",40),e.NdJ("click",function(){return o.registrarUsuario()}),e._uU(85," Registrar "),e.qZA()()()()()()()(),e.YNc(86,Xe,1,1,"app-loader",41)),2&r){const n=e.MAs(49);e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("ngIf",null==o.nombre?null:o.nombre.errors),e.xp6(5),e.Q6J("ngIf",null==o.apellido?null:o.apellido.errors),e.xp6(5),e.Q6J("ngIf",null==o.edad?null:o.edad.errors),e.xp6(5),e.Q6J("ngIf",o.validarDni.validando),e.xp6(1),e.Q6J("ngIf",null==o.dni?null:o.dni.errors),e.xp6(9),e.Q6J("ngForOf",o.especialidadesVisibles),e.xp6(4),e.Q6J("ngIf",null==o.especialidad?null:o.especialidad.errors),e.xp6(7),e.Q6J("ngClass",e.VKq(21,We,!n.checked))("readOnly",!n.checked),e.xp6(1),e.Q6J("ngIf",o.validarEspecialidad.validando),e.xp6(1),e.Q6J("ngIf",null==o.otroEspecialidad?null:o.otroEspecialidad.errors),e.xp6(9),e.Q6J("ngIf",o.validarCorreo.validando),e.xp6(1),e.Q6J("ngIf",null==o.correo?null:o.correo.errors),e.xp6(5),e.Q6J("ngIf",null==o.clave?null:o.clave.errors),e.xp6(5),e.Q6J("ngIf",null==o.confirmarClave?null:o.confirmarClave.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen1?null:o.imagen1.errors),e.xp6(1),e.Q6J("formGroup",o.aFormGroup),e.xp6(1),e.Q6J("siteKey",o.siteKey),e.xp6(7),e.Q6J("ngIf",o.cargando)}},dependencies:[g.mk,g.sg,g.O5,a._Y,a.YN,a.Kr,a.Fj,a.Wl,a.EJ,a.JJ,a.JL,a.sg,a.u,T.R,Z.to,g.rS],styles:[".error[_ngcontent-%COMP%]{color:red}.deshabilitado[_ngcontent-%COMP%]{background-color:var(--bs-secondary-bg)!important}.display[_ngcontent-%COMP%]{display:flex}.width[_ngcontent-%COMP%]{width:30%}.fijo[_ngcontent-%COMP%]{resize:none;height:auto}@media (max-width: 700px){.display[_ngcontent-%COMP%]{display:block}.width[_ngcontent-%COMP%]{width:100%}}"]}),i})()}]}];let rr=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[f.Bz.forChild(er),f.Bz]}),i})();var or=m(4466);let ir=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.ez,rr,a.u5,a.UX,or.m,Z.e7]}),i})()}}]);