"use strict";(self.webpackChunkTP_CLINICA=self.webpackChunkTP_CLINICA||[]).push([[594],{9594:(ei,Pe,h)=>{h.r(Pe),h.d(Pe,{RegistroModule:()=>Ko});var I=h(6895),F=h(6378),J=h(3474),e=h(4650),oe=h(7556),X=h(1209);function kt(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",6)(2,"h3",7),e._uU(3," Seleccione el tipo de usuario que desea registrar. "),e.qZA(),e._UZ(4,"img",8),e.qZA(),e.BQk())}let St=(()=>{class t{constructor(r,o,i){this.authService=r,this.usuarioService=o,this.router=i,this.ocultarBtnCuentaUsuario=!1,this.ocultarBtnCuentaAdmin=!1,this.ocultarBtnCuentaEspecialista=!1,this.ocultarLogo=!1}ngOnInit(){let r=this.router.url;this.ocultarLogo="/registro"!=r&&"/usuarios/registro"!=r,this.ocultarBtnCuentaEspecialista=r.includes("registro/especialista"),this.ocultarBtnCuentaUsuario=r.includes("registro/usuario"),this.ocultarBtnCuentaAdmin=r.includes("registro/administrador")}esAdministrador(){let r=this.verificarEstadoDeUsuario();return null!=r&&r.perfil==J.L.administrador}usuarioEstaLogueado(){return this.usuarioService.getUsuarioEstaLogueado}verificarEstadoDeUsuario(){return this.usuarioService.getUsuarioActualBasico}cuenta(r){1==r?(this.ocultarBtnCuentaAdmin=!0,this.ocultarBtnCuentaUsuario=!1,this.ocultarBtnCuentaEspecialista=!1):2==r?(this.ocultarBtnCuentaAdmin=!1,this.ocultarBtnCuentaUsuario=!1,this.ocultarBtnCuentaEspecialista=!0):3==r&&(this.ocultarBtnCuentaAdmin=!1,this.ocultarBtnCuentaUsuario=!0,this.ocultarBtnCuentaEspecialista=!1),this.ocultarLogo=!0}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(oe.e),e.Y36(X.i),e.Y36(F.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-registro"]],decls:11,vars:5,consts:[["routerLink","",1,"btn","btn-primary","fs-4","fw-bold","p-2","m-2",3,"hidden"],[4,"ngIf"],[1,"d-flex","justify-content-center"],["routerLink","administrador",1,"btn","btn-primary","fs-4","fw-bold","p-2","m-2",3,"hidden","click"],["routerLink","especialista",1,"btn","btn-primary","fs-4","fw-bold","p-2","m-2",3,"hidden","click"],["routerLink","usuario",1,"btn","btn-primary","fs-4","fw-bold","p-2","m-2",3,"hidden","click"],[1,"text-center"],[1,"fw-bold","fs-2","text-dark"],["src","assets/logo/logo192x192.png","alt","imagen-usuario",1,"card-img-top","w-25"]],template:function(r,o){1&r&&(e.TgZ(0,"button",0),e._uU(1,"Volver a Bienvenido"),e.qZA(),e.YNc(2,kt,5,0,"ng-container",1),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return o.cuenta(1)}),e._uU(5,"Registro Administrador"),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return o.cuenta(2)}),e._uU(7,"Registro Especialista"),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return o.cuenta(3)}),e._uU(9,"Registro Usuario"),e.qZA()(),e._UZ(10,"router-outlet")),2&r&&(e.Q6J("hidden",o.usuarioEstaLogueado()),e.xp6(2),e.Q6J("ngIf",!o.ocultarLogo),e.xp6(2),e.Q6J("hidden",o.ocultarBtnCuentaAdmin||!o.esAdministrador()),e.xp6(2),e.Q6J("hidden",o.ocultarBtnCuentaEspecialista),e.xp6(2),e.Q6J("hidden",o.ocultarBtnCuentaUsuario))},dependencies:[I.O5,F.lC,F.rH]}),t})();var B=h(5861),u=h(4006),_e=h(4128),k=h(4500);class Nt{constructor(){this.id="",this.correo="",this.nombre="",this.apellido="",this.dni=0,this.imagen1="",this.imagen2="",this.edad=0,this.obraSocial=0,this.habilitado=k.j.espera,this.correoRegistrado=!1,this.perfil=J.L.usuario,this.fechaRegistro=new Date}}class Q{constructor(){this.validando=!1}}var f=h(5708),ie=h(6069),ve=h(9724),It=h(7272),Fe=h(4482),Le=h(5403),Zt=h(5032),Pt=h(9770),Ft=h(9751),De=h(9646),ae=h(8996),Lt=h(4986),Mt=h(4004),Me=h(3900),W=h(4976),se=h(2011),qt=h(3942),le=h(6881),S=h(2090),qe=h(4859);const je="firebasestorage.googleapis.com",Be="storageBucket";class _ extends S.ZR{constructor(n,r,o=0){super(be(n),`Firebase Storage: ${r} (${be(n)})`),this.status_=o,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,_.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return be(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var m=(()=>{return(t=m||(m={})).UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",m;var t})();function be(t){return"storage/"+t}function Re(){return new _(m.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Qe(){return new _(m.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Ye(){return new _(m.CANCELED,"User canceled the upload/download.")}function Je(){return new _(m.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $(t){return new _(m.INVALID_ARGUMENT,t)}function $e(){return new _(m.APP_DELETED,"The Firebase app was deleted.")}function Ve(t){return new _(m.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function K(t,n){return new _(m.INVALID_FORMAT,"String does not match format '"+t+"': "+n)}function ee(t){throw new _(m.INTERNAL_ERROR,"Internal error: "+t)}class y{constructor(n,r){this.bucket=n,this.path_=r}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,r){let o;try{o=y.makeFromUrl(n,r)}catch{return new y(n,"")}if(""===o.path)return o;throw function zt(t){return new _(m.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(n)}static makeFromUrl(n,r){let o=null;const i="([A-Za-z0-9.\\-_]+)",l=new RegExp("^gs://"+i+"(/(.*))?$","i");function d(x){x.path_=decodeURIComponent(x.path)}const v=r.replace(/[.]/g,"\\."),w=[{regex:l,indices:{bucket:1,path:3},postModify:function a(x){"/"===x.path.charAt(x.path.length-1)&&(x.path_=x.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${v}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:d},{regex:new RegExp(`^https?://${r===je?"(?:storage.googleapis.com|storage.cloud.google.com)":r}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:d}];for(let x=0;x<w.length;x++){const G=w[x],z=G.regex.exec(n);if(z){let ne=z[G.indices.path];ne||(ne=""),o=new y(z[G.indices.bucket],ne),G.postModify(o);break}}if(null==o)throw function Gt(t){return new _(m.INVALID_URL,"Invalid URL '"+t+"'.")}(n);return o}}class tr{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}function ce(t){return"string"==typeof t||t instanceof String}function He(t){return Te()&&t instanceof Blob}function Te(){return typeof Blob<"u"&&!(0,S.UG)()}function xe(t,n,r,o){if(o<n)throw $(`Invalid value for '${t}'. Expected ${n} or greater.`);if(o>r)throw $(`Invalid value for '${t}'. Expected ${r} or less.`)}function L(t,n,r){let o=n;return null==r&&(o=`https://${n}`),`${r}://${o}/v0${t}`}function Ge(t){const n=encodeURIComponent;let r="?";for(const o in t)t.hasOwnProperty(o)&&(r=r+(n(o)+"=")+n(t[o])+"&");return r=r.slice(0,-1),r}var j=(()=>{return(t=j||(j={}))[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",j;var t})();function ze(t,n){const r=t>=500&&t<600,i=-1!==[408,429].indexOf(t),a=-1!==n.indexOf(t);return r||i||a}class sr{constructor(n,r,o,i,a,s,l,c,d,p,v,g=!0){this.url_=n,this.method_=r,this.headers_=o,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=l,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=v,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,R)=>{this.resolve_=b,this.reject_=R,this.start_()})}start_(){const r=(o,i)=>{const a=this.resolve_,s=this.reject_,l=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());!function or(t){return void 0!==t}(c)?a():a(c)}catch(c){s(c)}else if(null!==l){const c=Re();c.serverResponse=l.getErrorText(),s(this.errorCallback_?this.errorCallback_(l,c):c)}else s(i.canceled?this.appDelete_?$e():Ye():Qe())};this.canceled_?r(0,new ue(!1,null,!0)):this.backoffId_=function rr(t,n,r){let o=1,i=null,a=null,s=!1,l=0;function c(){return 2===l}let d=!1;function p(...T){d||(d=!0,n.apply(null,T))}function v(T){i=setTimeout(()=>{i=null,t(b,c())},T)}function g(){a&&clearTimeout(a)}function b(T,...M){if(d)return void g();if(T)return g(),void p.call(null,T,...M);if(c()||s)return g(),void p.call(null,T,...M);let w;o<64&&(o*=2),1===l?(l=2,w=0):w=1e3*(o+Math.random()),v(w)}let R=!1;function E(T){R||(R=!0,g(),!d&&(null!==i?(T||(l=2),clearTimeout(i),v(0)):T||(l=1)))}return v(0),a=setTimeout(()=>{s=!0,E(!0)},r),E}((o,i)=>{if(i)return void o(!1,new ue(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const s=l=>{null!==this.progressCallback_&&this.progressCallback_(l.loaded,l.lengthComputable?l.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const l=a.getErrorCode()===j.NO_ERROR,c=a.getStatus();if(!l||ze(c,this.additionalRetryCodes_)&&this.retry){const p=a.getErrorCode()===j.ABORT;return void o(!1,new ue(!1,null,p))}const d=-1!==this.successCodes_.indexOf(c);o(!0,new ue(d,a))})},r,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,null!==this.backoffId_&&function nr(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class ue{constructor(n,r,o){this.wasSuccessCode=n,this.connection=r,this.canceled=!!o}}function pr(...t){const n=function fr(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==n){const r=new n;for(let o=0;o<t.length;o++)r.append(t[o]);return r.getBlob()}if(Te())return new Blob(t);throw new _(m.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const C={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ye{constructor(n,r){this.data=n,this.contentType=r||null}}function we(t,n){switch(t){case C.RAW:return new ye(Xe(n));case C.BASE64:case C.BASE64URL:return new ye(We(t,n));case C.DATA_URL:return new ye(function vr(t){const n=new Ke(t);return n.base64?We(C.BASE64,n.rest):function _r(t){let n;try{n=decodeURIComponent(t)}catch{throw K(C.DATA_URL,"Malformed data URL.")}return Xe(n)}(n.rest)}(n),function br(t){return new Ke(t).contentType}(n))}throw Re()}function Xe(t){const n=[];for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<=127?n.push(o):o<=2047?n.push(192|o>>6,128|63&o):55296==(64512&o)?r<t.length-1&&56320==(64512&t.charCodeAt(r+1))?(o=65536|(1023&o)<<10|1023&t.charCodeAt(++r),n.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|63&o)):n.push(239,191,189):56320==(64512&o)?n.push(239,191,189):n.push(224|o>>12,128|o>>6&63,128|63&o)}return new Uint8Array(n)}function We(t,n){switch(t){case C.BASE64:{const i=-1!==n.indexOf("-"),a=-1!==n.indexOf("_");if(i||a)throw K(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case C.BASE64URL:{const i=-1!==n.indexOf("+"),a=-1!==n.indexOf("/");if(i||a)throw K(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=function gr(t){if(typeof atob>"u")throw function er(t){return new _(m.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(n)}catch(i){throw i.message.includes("polyfill")?i:K(t,"Invalid character found")}const o=new Uint8Array(r.length);for(let i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return o}class Ke{constructor(n){this.base64=!1,this.contentType=null;const r=n.match(/^data:([^,]+)?,/);if(null===r)throw K(C.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const o=r[1]||null;null!=o&&(this.base64=function Rr(t,n){return t.length>=n.length&&t.substring(t.length-n.length)===n}(o,";base64"),this.contentType=this.base64?o.substring(0,o.length-7):o),this.rest=n.substring(n.indexOf(",")+1)}}class Z{constructor(n,r){let o=0,i="";He(n)?(this.data_=n,o=n.size,i=n.type):n instanceof ArrayBuffer?(r?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),o=this.data_.length):n instanceof Uint8Array&&(r?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),o=n.length),this.size_=o,this.type_=i}size(){return this.size_}type(){return this.type_}slice(n,r){if(He(this.data_)){const i=function mr(t,n,r){return t.webkitSlice?t.webkitSlice(n,r):t.mozSlice?t.mozSlice(n,r):t.slice?t.slice(n,r):null}(this.data_,n,r);return null===i?null:new Z(i)}{const o=new Uint8Array(this.data_.buffer,n,r-n);return new Z(o,!0)}}static getBlob(...n){if(Te()){const r=n.map(o=>o instanceof Z?o.data_:o);return new Z(pr.apply(null,r))}{const r=n.map(s=>ce(s)?we(C.RAW,s).data:s.data_);let o=0;r.forEach(s=>{o+=s.byteLength});const i=new Uint8Array(o);let a=0;return r.forEach(s=>{for(let l=0;l<s.length;l++)i[a++]=s[l]}),new Z(i,!0)}}uploadData(){return this.data_}}function Ue(t){let n;try{n=JSON.parse(t)}catch{return null}return function ar(t){return"object"==typeof t&&!Array.isArray(t)}(n)?n:null}function et(t){const n=t.lastIndexOf("/",t.length-2);return-1===n?t:t.slice(n+1)}function yr(t,n){return n}class U{constructor(n,r,o,i){this.server=n,this.local=r||n,this.writable=!!o,this.xform=i||yr}}let de=null;function te(){if(de)return de;const t=[];t.push(new U("bucket")),t.push(new U("generation")),t.push(new U("metageneration")),t.push(new U("name","fullPath",!0));const r=new U("name");r.xform=function n(a,s){return function wr(t){return!ce(t)||t.length<2?t:et(t)}(s)},t.push(r);const i=new U("size");return i.xform=function o(a,s){return void 0!==s?Number(s):s},t.push(i),t.push(new U("timeCreated")),t.push(new U("updated")),t.push(new U("md5Hash",null,!0)),t.push(new U("cacheControl",null,!0)),t.push(new U("contentDisposition",null,!0)),t.push(new U("contentEncoding",null,!0)),t.push(new U("contentLanguage",null,!0)),t.push(new U("contentType",null,!0)),t.push(new U("metadata","customMetadata",!0)),de=t,de}function tt(t,n,r){const o=Ue(n);return null===o?null:function Ar(t,n,r){const o={type:"file"},i=r.length;for(let a=0;a<i;a++){const s=r[a];o[s.local]=s.xform(o,n[s.server])}return function Ur(t,n){Object.defineProperty(t,"ref",{get:function r(){const a=new y(t.bucket,t.fullPath);return n._makeStorageReference(a)}})}(o,t),o}(t,o,r)}function Ae(t,n){const r={},o=n.length;for(let i=0;i<o;i++){const a=n[i];a.writable&&(r[a.server]=t[a.local])}return JSON.stringify(r)}const rt="prefixes",nt="items";class O{constructor(n,r,o,i){this.url=n,this.method=r,this.handler=o,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function P(t){if(!t)throw Re()}function he(t,n){return function r(o,i){const a=tt(t,i,n);return P(null!==a),a}}function V(t){return function n(r,o){let i;return i=401===r.getStatus()?r.getErrorText().includes("Firebase App Check token is invalid")?function Vt(){return new _(m.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function $t(){return new _(m.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===r.getStatus()?function Jt(t){return new _(m.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===r.getStatus()?function Ht(t){return new _(m.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):o,i.status=r.getStatus(),i.serverResponse=o.serverResponse,i}}function re(t){const n=V(t);return function r(o,i){let a=n(o,i);return 404===o.getStatus()&&(a=function Yt(t){return new _(m.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(t.path)),a.serverResponse=i.serverResponse,a}}function ot(t,n,r){const i=L(n.fullServerUrl(),t.host,t._protocol),s=t.maxOperationRetryTime,l=new O(i,"GET",he(t,r),s);return l.errorHandler=re(n),l}function Ir(t,n,r,o,i){const a={};a.prefix=n.isRoot?"":n.path+"/",r&&r.length>0&&(a.delimiter=r),o&&(a.pageToken=o),i&&(a.maxResults=i);const l=L(n.bucketOnlyServerUrl(),t.host,t._protocol),d=t.maxOperationRetryTime,p=new O(l,"GET",function Sr(t,n){return function r(o,i){const a=function kr(t,n,r){const o=Ue(r);return null===o?null:function Er(t,n,r){const o={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[rt])for(const i of r[rt]){const a=i.replace(/\/$/,""),s=t._makeStorageReference(new y(n,a));o.prefixes.push(s)}if(r[nt])for(const i of r[nt]){const a=t._makeStorageReference(new y(n,i.name));o.items.push(a)}return o}(t,n,o)}(t,n,i);return P(null!==a),a}}(t,n.bucket),d);return p.urlParams=a,p.errorHandler=V(n),p}function at(t,n,r){const o=Object.assign({},r);return o.fullPath=t.path,o.size=n.size(),o.contentType||(o.contentType=function Fr(t,n){return t&&t.contentType||n&&n.type()||"application/octet-stream"}(null,n)),o}class fe{constructor(n,r,o,i){this.current=n,this.total=r,this.finalized=!!o,this.metadata=i||null}}function Ce(t,n){let r=null;try{r=t.getResponseHeader("X-Goog-Upload-Status")}catch{P(!1)}return P(!!r&&-1!==(n||["active"]).indexOf(r)),r}const qr={STATE_CHANGED:"state_changed"},A={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ee(t){switch(t){case"running":case"pausing":case"canceling":return A.RUNNING;case"paused":return A.PAUSED;case"success":return A.SUCCESS;case"canceled":return A.CANCELED;default:return A.ERROR}}class jr{constructor(n,r,o){if(function ir(t){return"function"==typeof t}(n)||null!=r||null!=o)this.next=n,this.error=r??void 0,this.complete=o??void 0;else{const a=n;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function H(t){return(...n)=>{Promise.resolve().then(()=>t(...n))}}let ct=null;class Br{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=j.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=j.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=j.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,r,o,i){if(this.sent_)throw ee("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,n,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==o?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ee("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ee("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ee("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ee("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",n)}}class Qr extends Br{initXhr(){this.xhr_.responseType="text"}}function N(){return ct?ct():new Qr}class ut{constructor(n,r,o=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=n,this._blob=r,this._metadata=o,this._mappings=te(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(m.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(ze(i.status,[])){if(!a)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=Qe()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(m.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const n=this._transferred;return r=>this._updateProgress(n+r)}_shouldDoResumable(n){return n.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(n){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([r,o])=>{switch(this._state){case"running":n(r,o);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((n,r)=>{const o=function Lr(t,n,r,o,i){const a=n.bucketOnlyServerUrl(),s=at(n,o,i),l={name:s.fullPath},c=L(a,t.host,t._protocol),p={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${o.size()}`,"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},v=Ae(s,r),R=new O(c,"POST",function b(E){let T;Ce(E);try{T=E.getResponseHeader("X-Goog-Upload-URL")}catch{P(!1)}return P(ce(T)),T},t.maxUploadRetryTime);return R.urlParams=l,R.headers=p,R.body=v,R.errorHandler=V(n),R}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(o,N,n,r);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const n=this._uploadUrl;this._resolveToken((r,o)=>{const i=function Dr(t,n,r,o){const c=new O(r,"POST",function a(d){const p=Ce(d,["active","final"]);let v=null;try{v=d.getResponseHeader("X-Goog-Upload-Size-Received")}catch{P(!1)}v||P(!1);const g=Number(v);return P(!isNaN(g)),new fe(g,o.size(),"final"===p)},t.maxUploadRetryTime);return c.headers={"X-Goog-Upload-Command":"query"},c.errorHandler=V(n),c}(this._ref.storage,this._ref._location,n,this._blob),a=this._ref.storage._makeRequest(i,N,r,o);this._request=a,a.getPromise().then(s=>{this._request=void 0,this._updateProgress(s.current),this._needToFetchStatus=!1,s.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const n=262144*this._chunkMultiplier,r=new fe(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken((i,a)=>{let s;try{s=function Mr(t,n,r,o,i,a,s,l){const c=new fe(0,0);if(s?(c.current=s.current,c.total=s.total):(c.current=0,c.total=o.size()),o.size()!==c.total)throw function Wt(){return new _(m.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}();const d=c.total-c.current;let p=d;i>0&&(p=Math.min(p,i));const v=c.current;let b="";b=0===p?"finalize":d===p?"upload, finalize":"upload";const R={"X-Goog-Upload-Command":b,"X-Goog-Upload-Offset":`${c.current}`},E=o.slice(v,v+p);if(null===E)throw Je();const w=new O(r,"POST",function T(x,G){const z=Ce(x,["active","final"]),Ze=c.current+p,ne=o.size();let Oe;return Oe="final"===z?he(n,a)(x,G):null,new fe(Ze,ne,"final"===z,Oe)},n.maxUploadRetryTime);return w.headers=R,w.body=E.uploadData(),w.progressCallback=l||null,w.errorHandler=V(t),w}(this._ref._location,this._ref.storage,o,this._blob,n,this._mappings,r,this._makeProgressCallback())}catch(c){return this._error=c,void this._transition("error")}const l=this._ref.storage._makeRequest(s,N,i,a,!1);this._request=l,l.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((n,r)=>{const o=ot(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(o,N,n,r);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((n,r)=>{const o=function st(t,n,r,o,i){const a=n.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},c=function l(){let w="";for(let x=0;x<2;x++)w+=Math.random().toString().slice(2);return w}();s["Content-Type"]="multipart/related; boundary="+c;const d=at(n,o,i),p=Ae(d,r),b=Z.getBlob("--"+c+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+p+"\r\n--"+c+"\r\nContent-Type: "+d.contentType+"\r\n\r\n",o,"\r\n--"+c+"--");if(null===b)throw Je();const R={name:d.fullPath},E=L(a,t.host,t._protocol),M=t.maxUploadRetryTime,q=new O(E,"POST",he(t,r),M);return q.urlParams=R,q.headers=s,q.body=b.uploadData(),q.errorHandler=V(n),q}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(o,N,n,r);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(n){const r=this._transferred;this._transferred=n,this._transferred!==r&&this._notifyObservers()}_transition(n){if(this._state!==n)switch(n){case"canceling":case"pausing":this._state=n,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const r="paused"===this._state;this._state=n,r&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=n,this._notifyObservers();break;case"canceled":this._error=Ye(),this._state=n,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const n=Ee(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:n,metadata:this._metadata,task:this,ref:this._ref}}on(n,r,o,i){const a=new jr(r||void 0,o||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(n,r){return this._promise.then(n,r)}catch(n){return this.then(null,n)}_addObserver(n){this._observers.push(n),this._notifyObserver(n)}_removeObserver(n){const r=this._observers.indexOf(n);-1!==r&&this._observers.splice(r,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(r=>{this._notifyObserver(r)})}_finishPromise(){if(void 0!==this._resolve){let n=!0;switch(Ee(this._state)){case A.SUCCESS:H(this._resolve.bind(null,this.snapshot))();break;case A.CANCELED:case A.ERROR:H(this._reject.bind(null,this._error))();break;default:n=!1}n&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(n){switch(Ee(this._state)){case A.RUNNING:case A.PAUSED:n.next&&H(n.next.bind(n,this.snapshot))();break;case A.SUCCESS:n.complete&&H(n.complete.bind(n))();break;default:n.error&&H(n.error.bind(n,this._error))()}}resume(){const n="paused"===this._state||"pausing"===this._state;return n&&this._transition("running"),n}pause(){const n="running"===this._state;return n&&this._transition("pausing"),n}cancel(){const n="running"===this._state||"pausing"===this._state;return n&&this._transition("canceling"),n}}class Y{constructor(n,r){this._service=n,this._location=r instanceof y?r:y.makeFromUrl(r,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,r){return new Y(n,r)}get root(){const n=new y(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return et(this._location.path)}get storage(){return this._service}get parent(){const n=function Tr(t){if(0===t.length)return null;const n=t.lastIndexOf("/");return-1===n?"":t.slice(0,n)}(this._location.path);if(null===n)return null;const r=new y(this._location.bucket,n);return new Y(this._service,r)}_throwIfRoot(n){if(""===this._location.path)throw Ve(n)}}function ht(t,n,r){return ke.apply(this,arguments)}function ke(){return(ke=(0,B.Z)(function*(t,n,r){const i=yield ft(t,{pageToken:r});n.prefixes.push(...i.prefixes),n.items.push(...i.items),null!=i.nextPageToken&&(yield ht(t,n,i.nextPageToken))})).apply(this,arguments)}function ft(t,n){null!=n&&"number"==typeof n.maxResults&&xe("options.maxResults",1,1e3,n.maxResults);const r=n||{},o=Ir(t.storage,t._location,"/",r.pageToken,r.maxResults);return t.storage.makeRequestWithTokens(o,N)}function tn(t){t._throwIfRoot("getDownloadURL");const n=function Zr(t,n,r){const i=L(n.fullServerUrl(),t.host,t._protocol),s=t.maxOperationRetryTime,l=new O(i,"GET",function Nr(t,n){return function r(o,i){const a=tt(t,i,n);return P(null!==a),function Cr(t,n,r,o){const i=Ue(n);if(null===i||!ce(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const s=encodeURIComponent;return a.split(",").map(d=>{const v=t.fullPath;return L("/b/"+s(t.bucket)+"/o/"+s(v),r,o)+Ge({alt:"media",token:d})})[0]}(a,i,t.host,t._protocol)}}(t,r),s);return l.errorHandler=re(n),l}(t.storage,t._location,te());return t.storage.makeRequestWithTokens(n,N).then(r=>{if(null===r)throw function Kt(){return new _(m.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return r})}function pt(t,n){const r=function xr(t,n){const r=n.split("/").filter(o=>o.length>0).join("/");return 0===t.length?r:t+"/"+r}(t._location.path,n),o=new y(t._location.bucket,r);return new Y(t.storage,o)}function mt(t,n){if(t instanceof Se){const r=t;if(null==r._bucket)throw function Xt(){return new _(m.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Be+"' property when initializing the app?")}();const o=new Y(r,r._bucket);return null!=n?mt(o,n):o}return void 0!==n?pt(t,n):t}function an(t,n){if(n&&function nn(t){return/^[A-Za-z]+:\/\//.test(t)}(n)){if(t instanceof Se)return function on(t,n){return new Y(t,n)}(t,n);throw $("To use ref(service, url), the first argument must be a Storage instance.")}return mt(t,n)}function gt(t,n){const r=n?.[Be];return null==r?null:y.makeFromBucketSpec(r,t)}class Se{constructor(n,r,o,i,a){this.app=n,this._authProvider=r,this._appCheckProvider=o,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=je,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?y.makeFromBucketSpec(i,this._host):gt(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._bucket=null!=this._url?y.makeFromBucketSpec(this._url,n):gt(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){xe("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){xe("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}_getAuthToken(){var n=this;return(0,B.Z)(function*(){if(n._overrideAuthToken)return n._overrideAuthToken;const r=n._authProvider.getImmediate({optional:!0});if(r){const o=yield r.getToken();if(null!==o)return o.accessToken}return null})()}_getAppCheckToken(){var n=this;return(0,B.Z)(function*(){const r=n._appCheckProvider.getImmediate({optional:!0});return r?(yield r.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new Y(this,n)}_makeRequest(n,r,o,i,a=!0){if(this._deleted)return new tr($e());{const s=function hr(t,n,r,o,i,a,s=!0){const l=Ge(t.urlParams),c=t.url+l,d=Object.assign({},t.headers);return function ur(t,n){n&&(t["X-Firebase-GMPID"]=n)}(d,n),function lr(t,n){null!==n&&n.length>0&&(t.Authorization="Firebase "+n)}(d,r),function cr(t,n){t["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}(d,a),function dr(t,n){null!==n&&(t["X-Firebase-AppCheck"]=n)}(d,o),new sr(c,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s)}(n,this._appId,o,i,r,this._firebaseVersion,a);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}makeRequestWithTokens(n,r){var o=this;return(0,B.Z)(function*(){const[i,a]=yield Promise.all([o._getAuthToken(),o._getAppCheckToken()]);return o._makeRequest(n,r,i,a).getPromise()})()}}const _t="@firebase/storage";function Rt(t,n){return an(t=(0,S.m9)(t),n)}function gn(t,{instanceIdentifier:n}){const r=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Se(r,o,i,n,le.SDK_VERSION)}!function _n(){(0,le._registerComponent)(new qe.wA("storage",gn,"PUBLIC").setMultipleInstances(!0)),(0,le.registerVersion)(_t,"0.11.2",""),(0,le.registerVersion)(_t,"0.11.2","esm2017")}();class pe{constructor(n,r,o){this._delegate=n,this.task=r,this.ref=o}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class xt{constructor(n,r){this._delegate=n,this._ref=r,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new pe(this._delegate.snapshot,this,this._ref)}then(n,r){return this._delegate.then(o=>{if(n)return n(new pe(o,this,this._ref))},r)}on(n,r,o,i){let a;return r&&(a="function"==typeof r?s=>r(new pe(s,this,this._ref)):{next:r.next?s=>r.next(new pe(s,this,this._ref)):void 0,complete:r.complete||void 0,error:r.error||void 0}),this._delegate.on(n,a,o||void 0,i||void 0)}}class yt{constructor(n,r){this._delegate=n,this._service=r}get prefixes(){return this._delegate.prefixes.map(n=>new D(n,this._service))}get items(){return this._delegate.items.map(n=>new D(n,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class D{constructor(n,r){this._delegate=n,this.storage=r}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(n){const r=function mn(t,n){return pt(t,n)}(this._delegate,n);return new D(r,this.storage)}get root(){return new D(this._delegate.root,this.storage)}get parent(){const n=this._delegate.parent;return null==n?null:new D(n,this.storage)}put(n,r){return this._throwIfRoot("put"),new xt(function ln(t,n,r){return function zr(t,n,r){return t._throwIfRoot("uploadBytesResumable"),new ut(t,new Z(n),r)}(t=(0,S.m9)(t),n,r)}(this._delegate,n,r),this)}putString(n,r=C.RAW,o){this._throwIfRoot("putString");const i=we(r,n),a=Object.assign({},o);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new xt(new ut(this._delegate,new Z(i.data,!0),a),this)}listAll(){return function hn(t){return function Wr(t){const n={prefixes:[],items:[]};return ht(t,n).then(()=>n)}(t=(0,S.m9)(t))}(this._delegate).then(n=>new yt(n,this.storage))}list(n){return function dn(t,n){return ft(t=(0,S.m9)(t),n)}(this._delegate,n||void 0).then(r=>new yt(r,this.storage))}getMetadata(){return function cn(t){return function Kr(t){t._throwIfRoot("getMetadata");const n=ot(t.storage,t._location,te());return t.storage.makeRequestWithTokens(n,N)}(t=(0,S.m9)(t))}(this._delegate)}updateMetadata(n){return function un(t,n){return function en(t,n){t._throwIfRoot("updateMetadata");const r=function Or(t,n,r,o){const a=L(n.fullServerUrl(),t.host,t._protocol),l=Ae(r,o),d=t.maxOperationRetryTime,p=new O(a,"PATCH",he(t,o),d);return p.headers={"Content-Type":"application/json; charset=utf-8"},p.body=l,p.errorHandler=re(n),p}(t.storage,t._location,n,te());return t.storage.makeRequestWithTokens(r,N)}(t=(0,S.m9)(t),n)}(this._delegate,n)}getDownloadURL(){return function fn(t){return tn(t=(0,S.m9)(t))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function pn(t){return function rn(t){t._throwIfRoot("deleteObject");const n=function Pr(t,n){const o=L(n.fullServerUrl(),t.host,t._protocol),l=new O(o,"DELETE",function s(c,d){},t.maxOperationRetryTime);return l.successCodes=[200,204],l.errorHandler=re(n),l}(t.storage,t._location);return t.storage.makeRequestWithTokens(n,N)}(t=(0,S.m9)(t))}(this._delegate)}_throwIfRoot(n){if(""===this._delegate._location.path)throw Ve(n)}}class wt{constructor(n,r){this.app=n,this._delegate=r}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(n){if(Ut(n))throw $("ref() expected a child path but got a URL, use refFromURL instead.");return new D(Rt(this._delegate,n),this)}refFromURL(n){if(!Ut(n))throw $("refFromURL() expected a full URL but got a child path, use ref() instead.");try{y.makeFromUrl(n,this._delegate.host)}catch{throw $("refFromUrl() expected a valid full URL but got an invalid one.")}return new D(Rt(this._delegate,n),this)}setMaxUploadRetryTime(n){this._delegate.maxUploadRetryTime=n}setMaxOperationRetryTime(n){this._delegate.maxOperationRetryTime=n}useEmulator(n,r,o={}){!function Tt(t,n,r,o={}){!function sn(t,n,r,o={}){t.host=`${n}:${r}`,t._protocol="http";const{mockUserToken:i}=o;i&&(t._overrideAuthToken="string"==typeof i?i:(0,S.Sg)(i,t.app.options.projectId))}(t,n,r,o)}(this._delegate,n,r,o)}}function Ut(t){return/^[A-Za-z]+:\/\//.test(t)}function Tn(t,{instanceIdentifier:n}){const r=t.getProvider("app-compat").getImmediate(),o=t.getProvider("storage").getImmediate({identifier:n});return new wt(r,o)}!function xn(t){const n={TaskState:A,TaskEvent:qr,StringFormat:C,Storage:wt,Reference:D};t.INTERNAL.registerComponent(new qe.wA("storage-compat",Tn,"PUBLIC").setServiceProps(n).setMultipleInstances(!0)),t.registerVersion("@firebase/storage-compat","0.3.2")}(qt.Z);var yn=h(2313);function At(t){const n=function wn(t){return new Ft.y(n=>{const r=s=>n.next(s);r(t.snapshot);const a=t.on("state_changed",r);return t.then(s=>{r(s),n.complete()},s=>{r(t.snapshot),(s=>{n.error(s)})(s)}),function(){a()}}).pipe(function Dt(t,n=Lt.z){return(0,Fe.e)((r,o)=>{let i=null,a=null,s=null;const l=()=>{if(i){i.unsubscribe(),i=null;const d=a;a=null,o.next(d)}};function c(){const d=s+t,p=n.now();if(p<d)return i=this.schedule(void 0,d-p),void o.add(i);l()}r.subscribe((0,Le.x)(o,d=>{a=d,s=n.now(),i||(i=n.schedule(c,t),o.add(i))},()=>{l(),o.complete()},void 0,()=>{a=i=null}))})}(0))}(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>n,percentageChanges:()=>n.pipe((0,Mt.U)(r=>r.bytesTransferred/r.totalBytes*100))}}function me(t){return{getDownloadURL:()=>(0,De.of)(void 0).pipe(W.fc,(0,Me.w)(()=>t.getDownloadURL()),W.iC),getMetadata:()=>(0,De.of)(void 0).pipe(W.fc,(0,Me.w)(()=>t.getMetadata()),W.iC),delete:()=>(0,ae.D)(t.delete()),child:n=>me(t.child(n)),updateMetadata:n=>(0,ae.D)(t.updateMetadata(n)),put:(n,r)=>At(t.put(n,r)),putString:(n,r,o)=>At(t.putString(n,r,o)),list:n=>(0,ae.D)(t.list(n)),listAll:()=>(0,ae.D)(t.listAll())}}h(9260);const Un=new e.OlP("angularfire2.storageBucket"),An=new e.OlP("angularfire2.storage.maxUploadRetryTime"),Cn=new e.OlP("angularfire2.storage.maxOperationRetryTime"),En=new e.OlP("angularfire2.storage.use-emulator");let kn=(()=>{class t{constructor(r,o,i,a,s,l,c,d,p,v){const g=(0,se.on)(r,s,o);this.storage=(0,se.cc)(`${g.name}.storage.${i}`,"AngularFireStorage",g.name,()=>{const b=s.runOutsideAngular(()=>g.storage(i||void 0)),R=p;return R&&b.useEmulator(...R),c&&b.setMaxUploadRetryTime(c),d&&b.setMaxOperationRetryTime(d),b},[c,d])}ref(r){return me(this.storage.ref(r))}refFromURL(r){return me(this.storage.refFromURL(r))}upload(r,o,i){return me(this.storage.ref(r)).put(o,i)}}return t.\u0275fac=function(r){return new(r||t)(e.LFG(se.Dh),e.LFG(se.xv,8),e.LFG(Un,8),e.LFG(e.Lbi),e.LFG(e.R0b),e.LFG(W.HU),e.LFG(An,8),e.LFG(Cn,8),e.LFG(En,8),e.LFG(yn.nm,8))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"any"}),t})();var ge=h(4465);let Ne=(()=>{class t{constructor(r,o){this.storage=r,this.toast=o}guardarArchivo(r,o){const i=this.storage.ref(o),a=this.storage.upload(o,r);return(0,It.z)(a.snapshotChanges().pipe(function Ot(){return(0,Fe.e)((t,n)=>{t.subscribe((0,Le.x)(n,Zt.Z))})}()),(0,Pt.P)(()=>i.getDownloadURL()))}guardarArchivoV2(r,o){var i=this;return(0,B.Z)(function*(){try{const a=i.storage.ref(o);return yield a.put(r),a.getDownloadURL()}catch(a){return i.toast.error(a.message),null}})()}obtenerArchivoPorURL(r){return this.storage.storage.refFromURL(r)}eliminarArchivoPorRutaAbsoluta(r){return this.storage.ref(r).delete()}eliminarArchivoPorURL(r){const o=this.obtenerArchivoPorURL(r);return this.storage.ref(o.fullPath).delete()}}return t.\u0275fac=function(r){return new(r||t)(e.LFG(kn),e.LFG(ge.k))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Ie=h(605);function Sn(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.nombre?null:o.nombre.getError(r).mensaje," ")}}function Nn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Sn,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.nombre?null:r.nombre.errors))}}function In(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.apellido?null:o.apellido.getError(r).mensaje," ")}}function Zn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,In,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.apellido?null:r.apellido.errors))}}function On(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.edad?null:o.edad.getError(r).mensaje," ")}}function Pn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,On,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.edad?null:r.edad.errors))}}function Fn(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",33)(2,"span",34),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",35),e.qZA(),e.BQk())}function Ln(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.dni?null:o.dni.getError(r).mensaje," ")}}function Dn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Ln,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.dni?null:r.dni.errors))}}function Mn(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.obraSocial?null:o.obraSocial.getError(r).mensaje," ")}}function qn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Mn,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.obraSocial?null:r.obraSocial.errors))}}function jn(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",33)(2,"span",34),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",35),e.qZA(),e.BQk())}function Bn(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.correo?null:o.correo.getError(r).mensaje," ")}}function Qn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Bn,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.correo?null:r.correo.errors))}}function Yn(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.clave?null:o.clave.getError(r).mensaje," ")}}function Jn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Yn,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.clave?null:r.clave.errors))}}function $n(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.confirmarClave?null:o.confirmarClave.getError(r).mensaje," ")}}function Vn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,$n,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.confirmarClave?null:r.confirmarClave.errors))}}function Hn(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen1?null:o.imagen1.getError(r).mensaje," ")}}function Gn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Hn,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen1?null:r.imagen1.errors))}}function zn(t,n){if(1&t&&(e.TgZ(0,"small",32),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen2?null:o.imagen2.getError(r).mensaje," ")}}function Xn(t,n){if(1&t&&(e.ynx(0),e.YNc(1,zn,2,1,"small",31),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen2?null:r.imagen2.errors))}}function Wn(t,n){1&t&&e._UZ(0,"app-loader")}let Kn=(()=>{class t{get nombre(){return this.form?.get("nombre")}set nombre(r){this.form?.get("nombre")?.patchValue(r)}get apellido(){return this.form?.get("apellido")}set apellido(r){this.form?.get("apellido")?.patchValue(r)}get edad(){return this.form?.get("edad")}set edad(r){this.form?.get("edad")?.patchValue(r)}get dni(){return this.form?.get("dni")}set dni(r){this.form?.get("dni")?.patchValue(r)}get obraSocial(){return this.form?.get("obraSocial")}set obraSocial(r){this.form?.get("obraSocial")?.patchValue(r)}get correo(){return this.form?.get("correo")}set correo(r){this.form?.get("correo")?.patchValue(r)}get clave(){return this.form?.get("clave")}set clave(r){this.form?.get("clave")?.patchValue(r)}get confirmarClave(){return this.form?.get("confirmarClave")}set confirmarClave(r){this.form?.get("confirmarClave")?.patchValue(r)}get imagen1(){return this.form?.get("imagen1")}set imagen1(r){this.form?.get("imagen1")?.patchValue(r)}get imagen2(){return this.form?.get("imagen2")}set imagen2(r){this.form?.get("imagen2")?.patchValue(r)}constructor(r,o,i,a,s,l,c){this.router=r,this.authService=o,this.formato=i,this.usuarioService=a,this.swalService=s,this.firestorageService=l,this.toastService=c,this.cargando=!1,this.archivos=[],this.validarCorreo=new Q,this.validarDni=new Q}ngOnInit(){this.form=new u.cw({nombre:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),apellido:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),edad:new u.NI("",{validators:[(0,f.Ms)(18,99)]}),dni:new u.NI("",{validators:[(0,f.Ms)(1e7,99999999)],asyncValidators:(0,f.j8)(this.usuarioService,this.validarDni),updateOn:"blur"}),obraSocial:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),imagen1:new u.NI("",{validators:[(0,f.FQ)()]}),imagen2:new u.NI("",{validators:[(0,f.FQ)()]}),correo:new u.NI("",{validators:[(0,f.qc)()],asyncValidators:(0,f.y$)(this.usuarioService,this.validarCorreo,this.formato),updateOn:"blur"}),clave:new u.NI("",{validators:[(0,f.$k)(6,20,null,!1,!1)]}),confirmarClave:new u.NI("",{validators:[(0,f.$k)(6,20,null,!1,!1)]})},[(0,f.U5)(6)])}obtenerErrores(r){return this.cargando?[]:Object.keys(r)}registrarUsuario(){this.formEsValido()?this.registrarUsuarioEnFirestore():this.toastService.error("Hay campos con errores. <br>Por favor corrijalos y vuelva a intentar","Registro inv\xe1lido.")}cargarArchivo(r,o){this.archivos[r]=o?.target?.files[0]}formEsValido(){for(const r in this.form.controls)if(this.form.controls.hasOwnProperty(r)&&this.form.controls[r]?.errors)return!1;return!(this.validarCorreo.validando||this.validarDni.validando)}registrarUsuarioEnFirestore(){var r=this;return(0,B.Z)(function*(){r.cargando=!0,r.authService.registrarUsuarioConVerificacion(r.correo?.value,r.clave?.value).then(o=>{let i=o.user?.uid;if(null!=i){let a=[];for(const s of r.archivos){let l=r.firestorageService.guardarArchivo(s,"fotosUsuario/"+r.nombre.value+"_"+Math.floor(1e3*Math.random())+"_"+r.formato.fechaToString(new Date,!1,!0));l.subscribe(c=>c),a.push(l)}(0,_e.D)(a).subscribe(s=>{if(s&&2==s.length){let l=new Nt;l.id=i??"",l.obraSocial=r.obraSocial.value,l.nombre=r.nombre.value,l.apellido=r.apellido.value,l.dni=r.dni.value,l.correo=r.formato.eliminarEspaciosYPasarAMin_May(r.correo.value),l.edad=r.edad.value,l.habilitado=k.j.habilitado,l.correoRegistrado=!0,l.imagen1=s[0],l.imagen2=s[1],l.fechaRegistro=new Date,r.usuarioService.cargarUsuarioConIdAsignado(l).then(c=>{r.limpiarFormulario(),r.cargando=!1,r.toastService.exito("El registro se ha completado exitosamente!.","Registro exitoso"),r.authService.logOut(),r.usuarioService.limpiarUsuarioActual(),r.swalService.exito("El registro se ha completado exitosamente. Por favor, ingrese a su cuenta para verificar su correo electr\xf3nico y, a continuaci\xf3n, inicie sesi\xf3n.","AVISO"),r.router.navigate(["../login"])})}})}else r.toastService.error("Ha ocurrido un error al intentar guardar los datos del usuario registrado.","Ha ocurrido un error."),r.cargando=!1}).catch(o=>{r.obtenerErrorAuth(o)})})()}obtenerErrorAuth(r){let o="";switch(r.code){case"auth/invalid-email":o="Formato de correo electr\xf3nico inv\xe1lido.";break;case"auth/missing-password":o="Falta ingresar la contrase\xf1a.";break;case"auth/weak-password":o="La contrase\xf1a debe contener al menos 6 caracteres.";break;case"auth/email-already-in-use":o="El correo electr\xf3nico ingresado ya est\xe1 en uso.";break;default:o="Ha ocurrido un error y no se pudo registrar el usuario."}""!=o&&(this.toastService.error(o,"Ha ocurrido un error!"),this.cargando=!1)}limpiarFormulario(){this.form.reset(),this.archivos=[];for(const r in this.form.controls)this.form.controls.hasOwnProperty(r)&&this.form.controls[r].setValue("")}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(F.F0),e.Y36(oe.e),e.Y36(ie.y),e.Y36(X.i),e.Y36(ve.J),e.Y36(Ne),e.Y36(ge.k))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-registro-usuario"]],decls:69,vars:16,consts:[[1,"container"],[1,"row","w-100","d-flex","justify-content-center","ml-0"],[1,"col","col-12","justify-content-center","col-lg-12"],[1,"card","p-4","mt-4","centrar","sombra-luminosa"],[3,"formGroup"],[1,"display","justify-content-between","w-100"],[1,"width","p-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","text","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],["for","obraSocial",1,"form-label"],["type","text","id","obraSocial","formControlName","obraSocial",1,"form-control"],["for","correo",1,"form-label"],["type","text","id","correo","formControlName","correo",1,"form-control"],["for","clave",1,"form-label"],["type","password","id","clave","formControlName","clave",1,"form-control"],["for","confirmarClave",1,"form-label"],["type","password","id","confirmarClave","formControlName","confirmarClave",1,"form-control"],["for","imagen1",1,"form-label"],["type","file","formControlName","imagen1","name","imagen1","id","imagen1","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],["for","imagen2",1,"form-label"],["type","file","formControlName","imagen2","name","imagen2","id","imagen2","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["type","button",1,"btn","btn-primary","mt-2","fw-bold",3,"click"],["class","d-block error",4,"ngFor","ngForOf"],[1,"d-block","error"],[1,"d-flex","justify-content-start",2,"align-items","center","height","100% !important"],[1,"m-0","fs-6","fw-bold","text-primary"],[1,"spinner-border","text-primary",2,"align-self","center","scale","0.5"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"fieldset")(6,"legend"),e._uU(7," Complete sus datos para registrarse (USUARIO) "),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"label",7),e._uU(12,"Nombre"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,Nn,2,1,"ng-container",9),e.qZA(),e.TgZ(15,"div")(16,"label",10),e._uU(17,"Apellido"),e.qZA(),e._UZ(18,"input",11),e.YNc(19,Zn,2,1,"ng-container",9),e.qZA(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Edad"),e.qZA(),e._UZ(23,"input",13),e.YNc(24,Pn,2,1,"ng-container",9),e.qZA(),e.TgZ(25,"div")(26,"label",14),e._uU(27,"DNI"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,Fn,5,0,"ng-container",9),e.YNc(30,Dn,2,1,"ng-container",9),e.qZA(),e.TgZ(31,"div")(32,"label",16),e._uU(33,"Obra Social"),e.qZA(),e._UZ(34,"input",17),e.YNc(35,qn,2,1,"ng-container",9),e.qZA()(),e.TgZ(36,"div",6)(37,"div")(38,"label",18),e._uU(39,"Correo Electronico"),e.qZA(),e._UZ(40,"input",19),e.YNc(41,jn,5,0,"ng-container",9),e.YNc(42,Qn,2,1,"ng-container",9),e.qZA(),e.TgZ(43,"div")(44,"label",20),e._uU(45,"Contrase\xf1a"),e.qZA(),e._UZ(46,"input",21),e.YNc(47,Jn,2,1,"ng-container",9),e.qZA(),e.TgZ(48,"div")(49,"label",22),e._uU(50,"Reingrese Contrase\xf1a"),e.qZA(),e._UZ(51,"input",23),e.YNc(52,Vn,2,1,"ng-container",9),e.qZA(),e.TgZ(53,"div")(54,"label",24),e._uU(55,"Imagen para Perfil (1)"),e.qZA(),e.TgZ(56,"input",25),e.NdJ("change",function(a){return o.cargarArchivo(0,a)}),e.qZA(),e.YNc(57,Gn,2,1,"ng-container",9),e.qZA(),e.TgZ(58,"div")(59,"label",26),e._uU(60,"Imagen para Perfil (2)"),e.qZA(),e.TgZ(61,"input",27),e.NdJ("change",function(a){return o.cargarArchivo(1,a)}),e.qZA(),e.YNc(62,Xn,2,1,"ng-container",9),e.qZA()()(),e.TgZ(63,"div",28)(64,"button",29),e.NdJ("click",function(){return o.limpiarFormulario()}),e._uU(65," Limpiar "),e.qZA(),e.TgZ(66,"button",30),e.NdJ("click",function(){return o.registrarUsuario()}),e._uU(67," Registrar "),e.qZA()()()()()()()(),e.YNc(68,Wn,1,0,"app-loader",9)),2&r&&(e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("ngIf",null==o.nombre?null:o.nombre.errors),e.xp6(5),e.Q6J("ngIf",null==o.apellido?null:o.apellido.errors),e.xp6(5),e.Q6J("ngIf",null==o.edad?null:o.edad.errors),e.xp6(5),e.Q6J("ngIf",o.validarDni.validando),e.xp6(1),e.Q6J("ngIf",null==o.dni?null:o.dni.errors),e.xp6(5),e.Q6J("ngIf",null==o.obraSocial?null:o.obraSocial.errors),e.xp6(6),e.Q6J("ngIf",o.validarCorreo.validando),e.xp6(1),e.Q6J("ngIf",null==o.correo?null:o.correo.errors),e.xp6(5),e.Q6J("ngIf",null==o.clave?null:o.clave.errors),e.xp6(5),e.Q6J("ngIf",null==o.confirmarClave?null:o.confirmarClave.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen1?null:o.imagen1.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen2?null:o.imagen2.errors),e.xp6(6),e.Q6J("ngIf",o.cargando))},dependencies:[I.sg,I.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,Ie.R],styles:[".error[_ngcontent-%COMP%]{color:red}.display[_ngcontent-%COMP%]{display:flex}.width[_ngcontent-%COMP%]{width:50%}@media (max-width: 700px){.display[_ngcontent-%COMP%]{display:block}.width[_ngcontent-%COMP%]{width:100%}}"]}),t})();class eo{constructor(){this.id="",this.correo="",this.nombre="",this.apellido="",this.dni=0,this.imagen="",this.edad=0,this.habilitado=k.j.espera,this.correoRegistrado=!1,this.perfil=J.L.administrador,this.fechaRegistro=new Date}}function to(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.nombre?null:o.nombre.getError(r).mensaje," ")}}function ro(t,n){if(1&t&&(e.ynx(0),e.YNc(1,to,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.nombre?null:r.nombre.errors))}}function no(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.apellido?null:o.apellido.getError(r).mensaje," ")}}function oo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,no,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.apellido?null:r.apellido.errors))}}function io(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.edad?null:o.edad.getError(r).mensaje," ")}}function ao(t,n){if(1&t&&(e.ynx(0),e.YNc(1,io,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.edad?null:r.edad.errors))}}function so(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",29)(2,"span",30),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",31),e.qZA(),e.BQk())}function lo(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.dni?null:o.dni.getError(r).mensaje," ")}}function co(t,n){if(1&t&&(e.ynx(0),e.YNc(1,lo,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.dni?null:r.dni.errors))}}function uo(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",29)(2,"span",30),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",31),e.qZA(),e.BQk())}function ho(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.correo?null:o.correo.getError(r).mensaje," ")}}function fo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,ho,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.correo?null:r.correo.errors))}}function po(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.clave?null:o.clave.getError(r).mensaje," ")}}function mo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,po,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.clave?null:r.clave.errors))}}function go(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.confirmarClave?null:o.confirmarClave.getError(r).mensaje," ")}}function _o(t,n){if(1&t&&(e.ynx(0),e.YNc(1,go,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.confirmarClave?null:r.confirmarClave.errors))}}function vo(t,n){if(1&t&&(e.TgZ(0,"small",28),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen1?null:o.imagen1.getError(r).mensaje," ")}}function bo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,vo,2,1,"small",27),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen1?null:r.imagen1.errors))}}function Ro(t,n){1&t&&e._UZ(0,"app-loader")}let To=(()=>{class t{get nombre(){return this.form?.get("nombre")}set nombre(r){this.form?.get("nombre")?.patchValue(r)}get apellido(){return this.form?.get("apellido")}set apellido(r){this.form?.get("apellido")?.patchValue(r)}get edad(){return this.form?.get("edad")}set edad(r){this.form?.get("edad")?.patchValue(r)}get dni(){return this.form?.get("dni")}set dni(r){this.form?.get("dni")?.patchValue(r)}get correo(){return this.form?.get("correo")}set correo(r){this.form?.get("correo")?.patchValue(r)}get clave(){return this.form?.get("clave")}set clave(r){this.form?.get("clave")?.patchValue(r)}get confirmarClave(){return this.form?.get("confirmarClave")}set confirmarClave(r){this.form?.get("confirmarClave")?.patchValue(r)}get imagen1(){return this.form?.get("imagen1")}set imagen1(r){this.form?.get("imagen1")?.patchValue(r)}constructor(r,o,i,a,s,l,c){this.router=r,this.authService=o,this.formato=i,this.usuarioService=a,this.swalService=s,this.firestorageService=l,this.toastService=c,this.cargando=!1,this.archivos=[],this.validarCorreo=new Q,this.validarDni=new Q}ngOnInit(){this.form=new u.cw({nombre:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),apellido:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),edad:new u.NI("",{validators:[(0,f.Ms)(18,99)]}),dni:new u.NI("",{validators:[(0,f.Ms)(1e7,99999999)],asyncValidators:(0,f.j8)(this.usuarioService,this.validarDni),updateOn:"blur"}),imagen1:new u.NI("",{validators:[(0,f.FQ)()]}),correo:new u.NI("",{validators:[(0,f.qc)()],asyncValidators:(0,f.y$)(this.usuarioService,this.validarCorreo,this.formato),updateOn:"blur"}),clave:new u.NI("",{validators:[(0,f.$k)(6,20,null,!1,!1)]}),confirmarClave:new u.NI("",{validators:[(0,f.$k)(6,20,null,!1,!1)]})},[(0,f.U5)(6)])}obtenerErrores(r){return this.cargando?[]:Object.keys(r)}registrarUsuario(){this.formEsValido()?this.registrarUsuarioEnFirestore():this.toastService.error("Hay campos con errores. <br>Por favor corrijalos y vuelva a intentar","Registro inv\xe1lido.")}cargarArchivo(r,o){this.archivos[r]=o?.target?.files[0]}formEsValido(){for(const r in this.form.controls)if(this.form.controls.hasOwnProperty(r)&&this.form.controls[r]?.errors)return!1;return!(this.validarCorreo.validando||this.validarDni.validando)}registrarUsuarioEnFirestore(){this.cargando=!0,this.authService.registrarUsuarioConVerificacion(this.correo?.value,this.clave?.value).then(r=>{let o=r.user?.uid;if(null!=o){let i=[];for(const a of this.archivos){let s=this.firestorageService.guardarArchivo(a,"fotosUsuario/"+this.nombre.value+"_"+Math.floor(1e3*Math.random())+"_"+this.formato.fechaToString(new Date,!1,!0));s.subscribe(l=>l),i.push(s)}(0,_e.D)(i).subscribe(a=>{if(a&&1==a.length){let s=new eo;s.id=o??"",s.nombre=this.nombre.value,s.apellido=this.apellido.value,s.dni=this.dni.value,s.correo=this.formato.eliminarEspaciosYPasarAMin_May(this.correo.value),s.edad=this.edad.value,s.habilitado=k.j.habilitado,s.correoRegistrado=!0,s.imagen=a[0],s.fechaRegistro=new Date,this.usuarioService.cargarUsuarioConIdAsignado(s).then(l=>{this.limpiarFormulario(),this.cargando=!1,this.toastService.exito("El registro se ha completado exitosamente!.","Registro exitoso"),this.authService.logOut(),this.usuarioService.limpiarUsuarioActual(),this.swalService.exito("El registro se ha completado exitosamente. Por favor, ingrese a su cuenta para verificar su correo electr\xf3nico y, a continuaci\xf3n, inicie sesi\xf3n.","AVISO"),this.router.navigate(["../login"])})}})}else this.toastService.error("Ha ocurrido un error al intentar guardar los datos del usuario registrado.","Ha ocurrido un error."),this.cargando=!1}).catch(r=>{this.obtenerErrorAuth(r)})}obtenerErrorAuth(r){let o="";switch(r.code){case"auth/invalid-email":o="Formato de correo electr\xf3nico inv\xe1lido.";break;case"auth/missing-password":o="Falta ingresar la contrase\xf1a.";break;case"auth/weak-password":o="La contrase\xf1a debe contener al menos 6 caracteres.";break;case"auth/email-already-in-use":o="El correo electr\xf3nico ingresado ya est\xe1 en uso.";break;default:o="Ha ocurrido un error y no se pudo registrar el usuario."}""!=o&&(this.toastService.error(o,"Ha ocurrido un error!"),this.cargando=!1)}limpiarFormulario(){this.form.reset(),this.archivos=[];for(const r in this.form.controls)this.form.controls.hasOwnProperty(r)&&this.form.controls[r].setValue("")}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(F.F0),e.Y36(oe.e),e.Y36(ie.y),e.Y36(X.i),e.Y36(ve.J),e.Y36(Ne),e.Y36(ge.k))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-registro-admin"]],decls:59,vars:13,consts:[[1,"container"],[1,"row","w-100","d-flex","justify-content-center","ml-0"],[1,"col","col-12","justify-content-center","col-lg-12"],[1,"card","p-4","mt-4","centrar","sombra-luminosa"],[3,"formGroup"],[1,"display","justify-content-between","w-100"],[1,"width","p-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","text","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],["for","correo",1,"form-label"],["type","text","id","correo","formControlName","correo",1,"form-control"],["for","clave",1,"form-label"],["type","password","id","clave","formControlName","clave",1,"form-control"],["for","confirmarClave",1,"form-label"],["type","password","id","confirmarClave","formControlName","confirmarClave",1,"form-control"],["for","imagen1",1,"form-label"],["type","file","formControlName","imagen1","name","imagen1","id","imagen1","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["type","button",1,"btn","btn-primary","mt-2","fw-bold",3,"click"],["class","d-block error",4,"ngFor","ngForOf"],[1,"d-block","error"],[1,"d-flex","justify-content-start",2,"align-items","center","height","100% !important"],[1,"m-0","fs-6","fw-bold","text-primary"],[1,"spinner-border","text-primary",2,"align-self","center","scale","0.5"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"fieldset")(6,"legend"),e._uU(7," Complete sus datos para registrarse (ADMIN) "),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"label",7),e._uU(12,"Nombre"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,ro,2,1,"ng-container",9),e.qZA(),e.TgZ(15,"div")(16,"label",10),e._uU(17,"Apellido"),e.qZA(),e._UZ(18,"input",11),e.YNc(19,oo,2,1,"ng-container",9),e.qZA(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Edad"),e.qZA(),e._UZ(23,"input",13),e.YNc(24,ao,2,1,"ng-container",9),e.qZA(),e.TgZ(25,"div")(26,"label",14),e._uU(27,"DNI"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,so,5,0,"ng-container",9),e.YNc(30,co,2,1,"ng-container",9),e.qZA()(),e.TgZ(31,"div",6)(32,"div")(33,"label",16),e._uU(34,"Correo Electronico"),e.qZA(),e._UZ(35,"input",17),e.YNc(36,uo,5,0,"ng-container",9),e.YNc(37,fo,2,1,"ng-container",9),e.qZA(),e.TgZ(38,"div")(39,"label",18),e._uU(40,"Contrase\xf1a"),e.qZA(),e._UZ(41,"input",19),e.YNc(42,mo,2,1,"ng-container",9),e.qZA(),e.TgZ(43,"div")(44,"label",20),e._uU(45,"Reingrese Contrase\xf1a"),e.qZA(),e._UZ(46,"input",21),e.YNc(47,_o,2,1,"ng-container",9),e.qZA(),e.TgZ(48,"div")(49,"label",22),e._uU(50,"Imagen para Perfil"),e.qZA(),e.TgZ(51,"input",23),e.NdJ("change",function(a){return o.cargarArchivo(0,a)}),e.qZA(),e.YNc(52,bo,2,1,"ng-container",9),e.qZA()()(),e.TgZ(53,"div",24)(54,"button",25),e.NdJ("click",function(){return o.limpiarFormulario()}),e._uU(55," Limpiar "),e.qZA(),e.TgZ(56,"button",26),e.NdJ("click",function(){return o.registrarUsuario()}),e._uU(57," Registrar "),e.qZA()()()()()()()(),e.YNc(58,Ro,1,0,"app-loader",9)),2&r&&(e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("ngIf",null==o.nombre?null:o.nombre.errors),e.xp6(5),e.Q6J("ngIf",null==o.apellido?null:o.apellido.errors),e.xp6(5),e.Q6J("ngIf",null==o.edad?null:o.edad.errors),e.xp6(5),e.Q6J("ngIf",o.validarDni.validando),e.xp6(1),e.Q6J("ngIf",null==o.dni?null:o.dni.errors),e.xp6(6),e.Q6J("ngIf",o.validarCorreo.validando),e.xp6(1),e.Q6J("ngIf",null==o.correo?null:o.correo.errors),e.xp6(5),e.Q6J("ngIf",null==o.clave?null:o.clave.errors),e.xp6(5),e.Q6J("ngIf",null==o.confirmarClave?null:o.confirmarClave.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen1?null:o.imagen1.errors),e.xp6(6),e.Q6J("ngIf",o.cargando))},dependencies:[I.sg,I.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,Ie.R],styles:[".error[_ngcontent-%COMP%]{color:red}.display[_ngcontent-%COMP%]{display:flex}.width[_ngcontent-%COMP%]{width:50%}@media (max-width: 700px){.display[_ngcontent-%COMP%]{display:block}.width[_ngcontent-%COMP%]{width:100%}}"]}),t})();class xo{constructor(){this.id="",this.correo="",this.nombre="",this.apellido="",this.dni=0,this.imagen="",this.edad=0,this.correoRegistrado=!1,this.perfil=J.L.especialista,this.especialidades=[],this.fechaRegistro=new Date,this.habilitado=k.j.espera}}var Ct=h(1588),Et=h(2668),yo=h(9215);function wo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.nombre?null:o.nombre.getError(r).mensaje," ")}}function Uo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,wo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.nombre?null:r.nombre.errors))}}function Ao(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.apellido?null:o.apellido.getError(r).mensaje," ")}}function Co(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Ao,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.apellido?null:r.apellido.errors))}}function Eo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.edad?null:o.edad.getError(r).mensaje," ")}}function ko(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Eo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.edad?null:r.edad.errors))}}function So(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",42)(2,"span",43),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",44),e.qZA(),e.BQk())}function No(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.dni?null:o.dni.getError(r).mensaje," ")}}function Io(t,n){if(1&t&&(e.ynx(0),e.YNc(1,No,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.dni?null:r.dni.errors))}}function Zo(t,n){if(1&t&&(e.TgZ(0,"option",45),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&t){const r=n.$implicit;e.s9C("value",r.id),e.xp6(1),e.hij(" ",e.lcZ(2,2,r.nombre)," ")}}function Oo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.especialidad?null:o.especialidad.getError(r).mensaje," ")}}function Po(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Oo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.especialidad?null:r.especialidad.errors))}}function Fo(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",42)(2,"span",43),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",44),e.qZA(),e.BQk())}function Lo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.otroEspecialidad?null:o.otroEspecialidad.getError(r).mensaje," ")}}function Do(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Lo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.otroEspecialidad?null:r.otroEspecialidad.errors))}}function Mo(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",42)(2,"span",43),e._uU(3,"Validando..."),e.qZA(),e._UZ(4,"div",44),e.qZA(),e.BQk())}function qo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.correo?null:o.correo.getError(r).mensaje," ")}}function jo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,qo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.correo?null:r.correo.errors))}}function Bo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.clave?null:o.clave.getError(r).mensaje," ")}}function Qo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Bo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.clave?null:r.clave.errors))}}function Yo(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.confirmarClave?null:o.confirmarClave.getError(r).mensaje," ")}}function Jo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,Yo,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.confirmarClave?null:r.confirmarClave.errors))}}function $o(t,n){if(1&t&&(e.TgZ(0,"small",41),e._uU(1),e.qZA()),2&t){const r=n.$implicit,o=e.oxw(2);e.xp6(1),e.hij(" ",null==o.imagen1?null:o.imagen1.getError(r).mensaje," ")}}function Vo(t,n){if(1&t&&(e.ynx(0),e.YNc(1,$o,2,1,"small",40),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.obtenerErrores(null==r.imagen1?null:r.imagen1.errors))}}function Ho(t,n){if(1&t&&e._UZ(0,"app-loader",46),2&t){const r=e.oxw();e.Q6J("texto",r.textoCarga)}}const Go=function(t){return{deshabilitado:t}},zo=[{path:"",component:St,children:[{path:"usuario",component:Kn},{path:"administrador",component:To,canActivate:[(()=>{class t{constructor(r,o){this.usuarioService=r,this.router=o}canActivate(r,o){return!(!this.usuarioService.getUsuarioActualBasico||this.usuarioService.getUsuarioActualBasico.perfil!=J.L.administrador)||(this.router.navigate(["home"]),!1)}canActivateChild(r,o){return!0}canDeactivate(r,o,i,a){return!0}}return t.\u0275fac=function(r){return new(r||t)(e.LFG(X.i),e.LFG(F.F0))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]},{path:"especialista",component:(()=>{class t{get nombre(){return this.form?.get("nombre")}set nombre(r){this.form?.get("nombre")?.patchValue(r)}get apellido(){return this.form?.get("apellido")}set apellido(r){this.form?.get("apellido")?.patchValue(r)}get edad(){return this.form?.get("edad")}set edad(r){this.form?.get("edad")?.patchValue(r)}get dni(){return this.form?.get("dni")}set dni(r){this.form?.get("dni")?.patchValue(r)}get correo(){return this.form?.get("correo")}set correo(r){this.form?.get("correo")?.patchValue(r)}get clave(){return this.form?.get("clave")}set clave(r){this.form?.get("clave")?.patchValue(r)}get confirmarClave(){return this.form?.get("confirmarClave")}set confirmarClave(r){this.form?.get("confirmarClave")?.patchValue(r)}get imagen1(){return this.form?.get("imagen1")}set imagen1(r){this.form?.get("imagen1")?.patchValue(r)}get especialidad(){return this.form?.get("especialidad")}set especialidad(r){this.form?.get("especialidad")?.patchValue(r)}get selectEspecialidades(){return this.form?.get("selectEspecialidades")}set selectEspecialidades(r){this.form?.get("selectEspecialidades")?.patchValue(r)}get otroEspecialidad(){return this.form?.get("otroEspecialidad")}set otroEspecialidad(r){this.form?.get("otroEspecialidad")?.patchValue(r)}get otro(){return this.form?.get("otro")}set otro(r){this.form?.get("otro")?.patchValue(r)}constructor(r,o,i,a,s,l,c,d,p,v,g){this.router=r,this.authService=o,this.swalService=i,this.especialidadService=a,this.formatoService=s,this.formato=l,this.usuarioService=c,this.firestorageService=d,this.solicitudService=p,this.especialidadesServices=v,this.toastService=g,this.cargando=!1,this.archivos=[],this.especialidades=[],this.especialidadesVisibles=[],this.especialidadesSeleccionadas=[],this.textoCarga="Cargando...",this.validarCorreo=new Q,this.validarDni=new Q,this.validarEspecialidad=new Q,this.usuarioActual=null}ngOnInit(){this.usuarioService.obtenerUsuarioActual().then(r=>{this.usuarioActual=r}),this.especialidadesServices.obtenerListadoDeEspecialidadesObservable().subscribe(r=>{this.especialidades=r.map(o=>({nombre:o.nombre,id:o.id})),this.especialidades.unshift({nombre:"Otro",id:0}),this.especialidadesVisibles=this.especialidades}),this.form=new u.cw({nombre:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),apellido:new u.NI("",{validators:[(0,f.$k)(3,30,null,!0,!0)]}),edad:new u.NI("",{validators:[(0,f.Ms)(18,99)]}),dni:new u.NI("",{validators:[(0,f.Ms)(1e7,99999999)],asyncValidators:(0,f.j8)(this.usuarioService,this.validarDni),updateOn:"blur"}),imagen1:new u.NI("",{validators:[(0,f.FQ)()]}),correo:new u.NI("",{validators:[(0,f.qc)()],asyncValidators:(0,f.y$)(this.usuarioService,this.validarCorreo,this.formato),updateOn:"blur"}),clave:new u.NI("",{validators:[(0,f.$k)(6,20,null,!1,!1)]}),confirmarClave:new u.NI("",{validators:[(0,f.$k)(6,20,null,!1,!1)]}),especialidad:new u.NI("",{validators:[(0,f.$k)(1,150,null)]}),otro:new u.NI(""),otroEspecialidad:new u.NI("",{validators:[(0,f.$k)(1,150,null)],asyncValidators:(0,f.sH)(this.especialidadesServices,this.validarEspecialidad,this.formato),updateOn:"blur"}),selectEspecialidades:new u.NI("")},[(0,f.U5)(6),(0,f.wb)(3,30,"otro","otroEspecialidad",null,!1,!0)])}obtenerErrores(r){return this.cargando?[]:Object.keys(r)}registrarUsuario(){this.formEsValido()?this.realizarSolicitud():this.toastService.error("Hay campos con errores. <br>Por favor corrijalos y vuelva a intentar","Registro inv\xe1lido.")}cargarArchivo(r,o){this.archivos[r]=o?.target?.files[0]}formEsValido(){for(const r in this.form.controls)if(this.form.controls.hasOwnProperty(r)&&this.form.controls[r]?.errors)return!1;return!(this.validarCorreo.validando||this.validarDni.validando||this.validarEspecialidad.validando)}realizarSolicitud(){this.cargando=!0,this.desuscribir();let r={};r.id=(0,Ct.Z)(),r.nombre=this.nombre.value,r.apellido=this.apellido.value,r.dni=this.dni.value,r.correo=this.formato.eliminarEspaciosYPasarAMin_May(this.correo.value),r.edad=this.edad.value,r.habilitado=k.j.espera,r.correoRegistrado=!0,r.otroEspecialidad=this.otro.value?this.formato.eliminarEspaciosYPasarAMin_May(this.otroEspecialidad.value):"",r.especialidades=this.especialidadesSeleccionadas.length>0?this.especialidadesSeleccionadas:[],r.fechaRegistro=new Date,null==this.usuarioActual?this.solicitudService.cargarSolicitudConIdAsignado(r).then(o=>{this.esperandoHabilitacion(r)}):this.usuarioActual.perfil==J.L.administrador&&this.aceptarAutomaticamente(r)}aceptarAutomaticamente(r){if(r.habilitado=k.j.habilitado,""!=r.otroEspecialidad){let o={id:(0,Ct.Z)(),nombre:this.formatoService.eliminarEspaciosYPasarAMin_May(r.otroEspecialidad)};this.especialidadService.cargarEspecialidadConIdAsignado(o).then(i=>{r.especialidades.push(o),this.cargarUsuarioAceptado(r)})}else this.cargarUsuarioAceptado(r)}cargarUsuarioAceptado(r){this.authService.registrarUsuarioConVerificacion(this.correo?.value,this.clave?.value).then(o=>{let i=o.user?.uid;null!=i&&null!=i?this.solicitudService.eliminarSolicitud(r.id).then(a=>{let s=[];for(const l of this.archivos){let c=this.firestorageService.guardarArchivo(l,"fotosUsuario/"+this.nombre.value+"_"+Math.floor(1e3*Math.random())+"_"+this.formato.fechaToString(new Date,!1,!0));c.subscribe(d=>d),s.push(c)}(0,_e.D)(s).subscribe(l=>{if(l&&1==l.length){let c=new xo;c.apellido=r.apellido,c.correo=r.correo,c.correoRegistrado=r.correoRegistrado,c.dni=r.dni,c.edad=r.edad,c.especialidades=r.especialidades,c.fechaRegistro=r.fechaRegistro,c.imagen=l[0],c.nombre=r.nombre,c.id=i??"",c.habilitado=k.j.habilitado,this.usuarioService.cargarUsuarioConIdAsignado(c).then(d=>{this.cargando=!1,null==this.usuarioActual&&this.toastService.exito("Se ha habilitado su ingreso!","Aviso.",3500),this.authService.logOut(),this.usuarioService.limpiarUsuarioActual(),this.swalService.exito("El registro se ha completado exitosamente. Por favor, ingrese a su cuenta para verificar su correo electr\xf3nico y, a continuaci\xf3n, inicie sesi\xf3n.","AVISO"),this.router.navigate(["../login"])})}})}):(this.toastService.error("Ha ocurrido un error al intentar guardar los datos del usuario registrado.","Ha ocurrido un error."),this.cargando=!1)}).catch(o=>{this.obtenerErrorAuth(o)})}obtenerErrorAuth(r){let o="";switch(r.code){case"auth/invalid-email":o="Formato de correo electr\xf3nico inv\xe1lido.";break;case"auth/missing-password":o="Falta ingresar la contrase\xf1a.";break;case"auth/weak-password":o="La contrase\xf1a debe contener al menos 6 caracteres.";break;case"auth/email-already-in-use":o="El correo electr\xf3nico ingresado ya est\xe1 en uso.";break;default:o="Ha ocurrido un error y no se pudo registrar el usuario."}""!=o&&(this.toastService.error(o,"Ha ocurrido un error!"),this.cargando=!1)}limpiarFormulario(){this.form.reset(),this.archivos=[];for(const r in this.form.controls)this.form.controls.hasOwnProperty(r)&&this.form.controls[r].setValue("");this.limpiarEspecialidad(),this.textoCarga="Cargando..."}limpiarEspecialidad(){this.especialidadesSeleccionadas=[],this.especialidadesVisibles=this.especialidades,this.selectEspecialidades.enable(),this.selectEspecialidades=-1,this.especialidad="",this.otroEspecialidad="",this.otro=!1}checked(r){r.target.checked||this.limpiarEspecialidad()}seleccion(r){let o=r.target.value,i=this.especialidades.filter(a=>a.id==o)[0];0==i.id?(this.especialidad=i.nombre,this.otro=!0,this.selectEspecialidades.disable()):(this.especialidad=""==this.especialidad.value?i.nombre:`${this.especialidad.value}/${i.nombre}`,this.especialidadesSeleccionadas.push(i),this.especialidadesVisibles=this.especialidades.filter(a=>!this.especialidadesSeleccionadas.includes(a)),this.selectEspecialidades=-1)}esperandoHabilitacion(r){var o=this;return(0,B.Z)(function*(){o.desuscribir(),o.textoCarga="Aguarde unos instantes. Esperando habilitaci\xf3n...",o.suscripcion=o.solicitudService.traerSolicitudPorId_Observable(r.id).subscribe(i=>{if(i&&1==i.length){let a=i[0];a&&a.habilitado!=k.j.espera&&(a.habilitado==k.j.habilitado?o.cargarUsuarioAceptado(a):a.habilitado==k.j.rechazado&&o.solicitudService.eliminarSolicitud(a.id).then(s=>{o.cargando=!1,o.toastService.error("Se ha rechazado su solicitud. Motivo: "+a.mensajeEstado,"Aviso",4e3)}))}})})()}desuscribir(){this.suscripcion&&this.suscripcion.unsubscribe()}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(F.F0),e.Y36(oe.e),e.Y36(ve.J),e.Y36(Et.T),e.Y36(ie.y),e.Y36(ie.y),e.Y36(X.i),e.Y36(Ne),e.Y36(yo.M),e.Y36(Et.T),e.Y36(ge.k))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-registro-especialista"]],decls:84,vars:21,consts:[[1,"container"],[1,"row","w-100","d-flex","justify-content-center","ml-0"],[1,"col","col-12","justify-content-center","col-lg-12"],[1,"card","p-4","mt-4","centrar","sombra-luminosa"],[3,"formGroup"],[1,"display","justify-content-between","w-100"],[1,"width","p-3"],["for","nombre",1,"form-label"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido",1,"form-label"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],["for","edad",1,"form-label"],["type","text","id","edad","formControlName","edad",1,"form-control"],["for","dni",1,"form-label"],["type","text","id","dni","formControlName","dni",1,"form-control"],["for","especialidad",1,"form-label","d-block"],["name","selectEspecialidades","id","selectEspecialidades","formControlName","selectEspecialidades",1,"w-100","form-select",3,"change"],["selected","","disabled","","value","-1"],[3,"value",4,"ngFor","ngForOf"],["readonly","","type","text","id","especialidad","formControlName","especialidad",1,"form-control","deshabilitado","fijo"],[1,"form-check"],["for","otroEspecialidad",1,"form-check-label"],["type","checkbox","formControlName","otro","id","otro","name","otro",1,"form-check-input",3,"change"],["check",""],["type","text","formControlName","otroEspecialidad","id","otroEspecialidad","name","otroEspecialidad",1,"form-control",3,"ngClass","readOnly"],[1,"d-flex","justify-content-end"],[1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["for","correo",1,"form-label"],["type","text","id","correo","formControlName","correo",1,"form-control"],["for","clave",1,"form-label"],["type","password","id","clave","formControlName","clave",1,"form-control"],["for","confirmarClave",1,"form-label"],["type","password","id","confirmarClave","formControlName","confirmarClave",1,"form-control"],["for","imagen1",1,"form-label"],["type","file","formControlName","imagen1","name","imagen1","id","imagen1","accept","image/png, image/jpeg, image/jpg",1,"form-control",3,"multiple","change"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary","mt-2","fw-bold",3,"click"],["type","button",1,"btn","btn-primary","mt-2","fw-bold",3,"click"],[3,"texto",4,"ngIf"],["class","d-block error",4,"ngFor","ngForOf"],[1,"d-block","error"],[1,"d-flex","justify-content-start",2,"align-items","center","height","100% !important"],[1,"m-0","fs-6","fw-bold","text-primary"],[1,"spinner-border","text-primary",2,"align-self","center","scale","0.5"],[3,"value"],[3,"texto"]],template:function(r,o){if(1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"fieldset")(6,"legend"),e._uU(7," Complete sus datos para registrarse (ESPECIALISTA) "),e.qZA(),e.TgZ(8,"div",5)(9,"div",6)(10,"div")(11,"label",7),e._uU(12,"Nombre"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,Uo,2,1,"ng-container",9),e.qZA(),e.TgZ(15,"div")(16,"label",10),e._uU(17,"Apellido"),e.qZA(),e._UZ(18,"input",11),e.YNc(19,Co,2,1,"ng-container",9),e.qZA(),e.TgZ(20,"div")(21,"label",12),e._uU(22,"Edad"),e.qZA(),e._UZ(23,"input",13),e.YNc(24,ko,2,1,"ng-container",9),e.qZA(),e.TgZ(25,"div")(26,"label",14),e._uU(27,"DNI"),e.qZA(),e._UZ(28,"input",15),e.YNc(29,So,5,0,"ng-container",9),e.YNc(30,Io,2,1,"ng-container",9),e.qZA()(),e.TgZ(31,"div",6)(32,"label",16),e._uU(33,"Especialidades"),e.qZA(),e.TgZ(34,"div")(35,"select",17),e.NdJ("change",function(a){return o.seleccion(a)}),e.TgZ(36,"optgroup")(37,"option",18),e._uU(38,"Seleccione especialidad..."),e.qZA(),e.YNc(39,Zo,3,4,"option",19),e.qZA()()(),e.TgZ(40,"label"),e._uU(41,"Especialidades seleccionadas"),e.qZA(),e._UZ(42,"textarea",20),e.YNc(43,Po,2,1,"ng-container",9),e.TgZ(44,"div")(45,"div",21)(46,"label",22),e._uU(47,"Agregar otra especialidad"),e.qZA(),e.TgZ(48,"input",23,24),e.NdJ("change",function(a){return o.checked(a)}),e.qZA()(),e._UZ(50,"input",25),e.YNc(51,Fo,5,0,"ng-container",9),e.YNc(52,Do,2,1,"ng-container",9),e.qZA(),e.TgZ(53,"div",26)(54,"button",27),e.NdJ("click",function(){return o.limpiarEspecialidad()}),e._uU(55,"Limpiar Especialidades"),e.qZA()()(),e.TgZ(56,"div",6)(57,"div")(58,"label",28),e._uU(59,"Correo Electronico"),e.qZA(),e._UZ(60,"input",29),e.YNc(61,Mo,5,0,"ng-container",9),e.YNc(62,jo,2,1,"ng-container",9),e.qZA(),e.TgZ(63,"div")(64,"label",30),e._uU(65,"Contrase\xf1a"),e.qZA(),e._UZ(66,"input",31),e.YNc(67,Qo,2,1,"ng-container",9),e.qZA(),e.TgZ(68,"div")(69,"label",32),e._uU(70,"Reingrese Contrase\xf1a"),e.qZA(),e._UZ(71,"input",33),e.YNc(72,Jo,2,1,"ng-container",9),e.qZA(),e.TgZ(73,"div")(74,"label",34),e._uU(75,"Imagen para Perfil"),e.qZA(),e.TgZ(76,"input",35),e.NdJ("change",function(a){return o.cargarArchivo(0,a)}),e.qZA(),e.YNc(77,Vo,2,1,"ng-container",9),e.qZA()()(),e.TgZ(78,"div",36)(79,"button",37),e.NdJ("click",function(){return o.limpiarFormulario()}),e._uU(80," Limpiar "),e.qZA(),e.TgZ(81,"button",38),e.NdJ("click",function(){return o.registrarUsuario()}),e._uU(82," Registrar "),e.qZA()()()()()()()(),e.YNc(83,Ho,1,1,"app-loader",39)),2&r){const i=e.MAs(49);e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("ngIf",null==o.nombre?null:o.nombre.errors),e.xp6(5),e.Q6J("ngIf",null==o.apellido?null:o.apellido.errors),e.xp6(5),e.Q6J("ngIf",null==o.edad?null:o.edad.errors),e.xp6(5),e.Q6J("ngIf",o.validarDni.validando),e.xp6(1),e.Q6J("ngIf",null==o.dni?null:o.dni.errors),e.xp6(9),e.Q6J("ngForOf",o.especialidadesVisibles),e.xp6(4),e.Q6J("ngIf",null==o.especialidad?null:o.especialidad.errors),e.xp6(7),e.Q6J("ngClass",e.VKq(19,Go,!i.checked))("readOnly",!i.checked),e.xp6(1),e.Q6J("ngIf",o.validarEspecialidad.validando),e.xp6(1),e.Q6J("ngIf",null==o.otroEspecialidad?null:o.otroEspecialidad.errors),e.xp6(9),e.Q6J("ngIf",o.validarCorreo.validando),e.xp6(1),e.Q6J("ngIf",null==o.correo?null:o.correo.errors),e.xp6(5),e.Q6J("ngIf",null==o.clave?null:o.clave.errors),e.xp6(5),e.Q6J("ngIf",null==o.confirmarClave?null:o.confirmarClave.errors),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngIf",null==o.imagen1?null:o.imagen1.errors),e.xp6(6),e.Q6J("ngIf",o.cargando)}},dependencies:[I.mk,I.sg,I.O5,u._Y,u.YN,u.Kr,u.Fj,u.Wl,u.EJ,u.JJ,u.JL,u.sg,u.u,Ie.R,I.rS],styles:[".error[_ngcontent-%COMP%]{color:red}.deshabilitado[_ngcontent-%COMP%]{background-color:var(--bs-secondary-bg)!important}.display[_ngcontent-%COMP%]{display:flex}.width[_ngcontent-%COMP%]{width:30%}.fijo[_ngcontent-%COMP%]{resize:none;height:auto}@media (max-width: 700px){.display[_ngcontent-%COMP%]{display:block}.width[_ngcontent-%COMP%]{width:100%}}"]}),t})()}]}];let Xo=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[F.Bz.forChild(zo),F.Bz]}),t})();var Wo=h(4466);let Ko=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[I.ez,Xo,u.u5,u.UX,Wo.m]}),t})()}}]);